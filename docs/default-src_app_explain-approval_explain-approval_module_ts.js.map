{"version":3,"file":"default-src_app_explain-approval_explain-approval_module_ts.js","mappings":"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","sources":["./src/app/explain-approval/explain-approval.page.ts","./src/app/explain-approval/explain-approval.page.scss","./src/app/explain-approval/explain-approval.module.ts","./src/app/explain-approval/explain-approval-routing.module.ts"],"sourcesContent":["/*\r\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\r\n\r\nThis file is part of vodle.\r\n\r\nvodle is free software: you can redistribute it and/or modify it under the \r\nterms of the GNU Affero General Public License as published by the Free \r\nSoftware Foundation, either version 3 of the License, or (at your option) \r\nany later version.\r\n\r\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \r\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \r\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \r\ndetails.\r\n\r\nYou should have received a copy of the GNU Affero General Public License \r\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \r\n*/\r\n\r\nimport { Component, OnInit, Input } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\nimport { GlobalService } from \"../global.service\";\r\nimport { PollPage } from '../poll/poll.module';  \r\nimport { Poll } from '../poll.service';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CommonModule } from '@angular/common';\r\n@Component({\r\n  imports: [ CommonModule, IonicModule, TranslateModule ],\r\n  selector: 'app-explain-approval',\r\n  templateUrl: './explain-approval.page.html',\r\n  styleUrls: ['./explain-approval.page.scss'],\r\n})\r\nexport class ExplainApprovalPage implements OnInit {\r\n\r\n  Math = Math;\r\n\r\n  @Input() parent: PollPage;\r\n  @Input() oid: string;\r\n\r\n  ready = false;\r\n  tab = \"approval\";\r\n  seen_tabs = new Set([this.tab]);\r\n\r\n  p: Poll;\r\n  optionname: string;\r\n\r\n  // data for approval animation:\r\n\r\n  rs: number[];\r\n  rmin: number;\r\n  a: number;\r\n  cs: string[];\r\n  ts: string[];\r\n  n: number;\r\n  myr: number;\r\n  myi: number;\r\n  myv: string;\r\n  thresholdi: number;\r\n  poss: number[];\r\n  // timing:\r\n  tr1 = 0; tr2 = 2;  // ratings needles\r\n  td1 = 2; td2 = 4;  // diagonal\r\n  tob1 = 4; tob2: number;  // opposition bar\r\n  dtt = 1; tt1: number; tt2: number;  // threshold\r\n  tab1: number; tab2 = 7;  // approval bar\r\n  to1 = 8; to2 = 9;  // own status\r\n  eff_unequal_proxy: boolean;\r\n\r\n  // data for share animation:\r\n  oids: string[];\r\n  os: string[];\r\n  ps: number[];\r\n  ss: number[];\r\n  dattrs: string[];\r\n\r\n  // svg code snippets:\r\n\r\n  text_y0_start = '<text y=\"0\">';\r\n  tspan_i_start = '<tspan font-style=\"italic\">';\r\n  tspan_end = '</tspan>';\r\n  text_end = '</text>'; \r\n\r\n  // styling:\r\n  approval_font_size_small = 3;\r\n  approval_font_size_normal = 3.75;\r\n  approval_font_size_large = 6;\r\n  share_font_size_small = 3;\r\n  share_font_size_normal = 3.75;\r\n  share_font_size_large = 6;\r\n\r\n\r\n  constructor(\r\n    private modalController: ModalController,\r\n    translate: TranslateService,\r\n    G: GlobalService) { \r\n  }\r\n\r\n  ngOnInit() {\r\n    // approval:\r\n    const p = this.p = this.parent.p,\r\n          oid = this.oid,\r\n          rs0 = (p.T.effective_ratings_ascending_map||new Map()).get(oid)||[],\r\n          rs = this.rs = [],\r\n          rmin = this.rmin = p.T.thresholds_map.get(oid) || 100,\r\n          cs = this.cs = [],\r\n          ts = this.ts = [],\r\n          poss = this.poss = [],\r\n          myr = this.myr = p.get_my_effective_rating(oid),\r\n          n = this.n = p.T.n_not_abstaining,\r\n          offset = n - rs0.length,\r\n          dur = this.tab2 - this.tob1 - this.dtt,\r\n          a = this.a = ((n>0) ? (p.T.approval_scores_map.get(oid) / n) : 0) || 0;\r\n    this.optionname = p.options[oid].name;\r\n    this.tob2 = this.tt1 = this.tob1 + dur*(1-a);\r\n    this.tt2 = this.tab1 = this.tt1 + this.dtt;\r\n    this.thresholdi = -1;\r\n    for (let i=0; i<n; i++) {\r\n      let r = i < offset ? 0 : rs0[i-offset];\r\n      rs.push(r);\r\n      cs.push((r == 0) ? '#d33939' : (r < rmin) ? '#3465a4' : '#62a73b');\r\n      ts.push(''+(this.tob1 + dur*i/n + (r < rmin ? 0 : this.dtt))+'s' )\r\n      poss.push(100*(i+.01)/n);\r\n      if (this.thresholdi < 0 && r >= rmin) {\r\n        this.thresholdi = i;\r\n      }\r\n    }\r\n    this.myi = rs.indexOf(myr);\r\n    this.eff_unequal_proxy = (myr != p.get_my_proxy_rating(oid));\r\n\r\n    this.parent.G.L.trace(\"ANIMATION:\",oid,rs,rmin,cs,myr,n,this.myi,this.a,poss,this.thresholdi);\r\n    this.parent.G.L.trace(\"ANIMATION:\",dur, this.tob2, this.tt2);\r\n\r\n    // share:\r\n    const nvs = {},\r\n          vids = [],\r\n          vm = p.T.votes_map,\r\n          dattrs = this.dattrs = [];\r\n    this.myv = vm.get(p.myvid);\r\n    let oids = this.oids = [],\r\n        os = this.os = [],\r\n        ps = this.ps = [],\r\n        ss = this.ss = [];\r\n    for (const [vid, ap] of p.T.approvals_map.get(oid)) {\r\n      if (ap) {\r\n        vids.push(vid);\r\n      }\r\n    }\r\n    for (const vid of vids) {\r\n      // find no. of voters who vote for oid2 instead of for oid\r\n      const oid2 = vm.get(vid);\r\n      if (!(oid2 in nvs)) {\r\n        nvs[oid2] = 0;\r\n      }\r\n      nvs[oid2]++;\r\n    }\r\n    this.parent.G.L.trace(\"partial share:\", vids, nvs);\r\n    let lastss = 0;\r\n    for (const oid2 of this.parent.oidsorted) {\r\n      if (oid2 in nvs || oid2 == oid) {\r\n        oids.push(oid2);\r\n        os.push(p.options[oid2].name);\r\n        const thisps = (n > 0) ? ((nvs[oid2] || 0) / n) : (1 / this.parent.oidsorted.length);\r\n        ps.push(thisps);\r\n        ss.push(lastss);\r\n        this.parent.G.L.trace(\"partial share:\", oid2, thisps, lastss);\r\n        lastss += thisps;\r\n      }\r\n      if (oid2 == oid) {\r\n        break; // since later options can't get votes from approvers of oid\r\n      }\r\n    }\r\n    if (os.length > 6) {\r\n      // need to summarize the last few!\r\n      let sumps = 0;\r\n      for (let index=4; index<os.length-1; index++) {\r\n        sumps += ps[index];\r\n      }\r\n      oids = this.oids = oids.slice(0, 4).concat(['', oids[-1]]);\r\n      os = this.os = os.slice(0, 4).concat(['other higher-ranked options', os[-1]]);\r\n      ps = this.ps = ps.slice(0, 4).concat([sumps, ps[-1]]);\r\n      ss = this.ss = ss.slice(0, 5).concat([ss[-1]]);\r\n    }\r\n    for (const i in ps) {\r\n      const share = ps[i],\r\n            R = this.parent.pieradius,\r\n            dx = R * Math.sin(this.parent.two_pi * share),\r\n            dy = R * (1 - Math.cos(this.parent.two_pi * share)),\r\n            more_than_180_degrees_flag = share > 0.5 ? 1 : 0;\r\n      if (share < 1) {\r\n        dattrs.push(\"M 0,0 l 0,-\"+R+\" a \"+R+\" \"+R+\" 0 \"+more_than_180_degrees_flag+\" 1 \"+dx+\" \"+dy+\" Z\");\r\n      } else { // a full circle\r\n        dattrs.push('d', \"M 0,0 l 0,-20 a 20 20 0 1 1 0 \"+(2*R)+\" a 20 20 0 1 1 0 \"+(-2*R)+\" Z\");\r\n      }\r\n    }\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    this.tab = \"approval\";\r\n    this.seen_tabs = new Set([this.tab]);\r\n  }\r\n  \r\n  ionViewDidEnter() {\r\n    this.ready = true;\r\n    window.setTimeout(this.restart, 100);\r\n  }\r\n\r\n  // top-row navigation:\r\n\r\n  back() {\r\n    if (this.tab=='approval') {\r\n      this.close();\r\n    } else {\r\n      this.go('approval');\r\n    }\r\n  }\r\n\r\n  forward() {\r\n    this.go('share');\r\n  }\r\n\r\n  go(tab: string) {\r\n    this.tab = tab;\r\n    if (!this.seen_tabs.has(tab)) {\r\n      this.seen_tabs.add(tab);\r\n      this.restart();\r\n    }\r\n  }\r\n\r\n  close()\r\n  {\r\n    this.modalController.dismiss();\r\n  }\r\n\r\n  // bottom-row controls:\r\n\r\n  restart() {\r\n    const svg = <SVGSVGElement><unknown>document.getElementById(\"animation\");\r\n    svg.setCurrentTime(0); \r\n  }\r\n\r\n  playing = true;\r\n\r\n  pause() {\r\n    const svg = <SVGSVGElement><unknown>document.getElementById(\"animation\");\r\n    svg.pauseAnimations();\r\n    this.playing = false;\r\n  }\r\n\r\n  unpause() {\r\n    const svg = <SVGSVGElement><unknown>document.getElementById(\"animation\");\r\n    svg.unpauseAnimations();\r\n    this.playing = true;\r\n  }\r\n\r\n  to_end() {\r\n    const svg = <SVGSVGElement><unknown>document.getElementById(\"animation\");\r\n    svg.setCurrentTime(100); \r\n  }\r\n\r\n}\r\n","// Imports\nvar ___CSS_LOADER_API_SOURCEMAP_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\");\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `@charset \"UTF-8\";\n/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/app/explain-approval/explain-approval.page.scss\"],\"names\":[],\"mappings\":\"AAAA,gBAAgB;AAAhB;;;;;;;;;;;;;;;;;CAAA\",\"sourcesContent\":[\"/*\\r\\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\\r\\n\\r\\nThis file is part of vodle.\\r\\n\\r\\nvodle is free software: you can redistribute it and/or modify it under the \\r\\nterms of the GNU Affero General Public License as published by the Free \\r\\nSoftware Foundation, either version 3 of the License, or (at your option) \\r\\nany later version.\\r\\n\\r\\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \\r\\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \\r\\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \\r\\ndetails.\\r\\n\\r\\nYou should have received a copy of the GNU Affero General Public License \\r\\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \\r\\n*/\\r\\n\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___.toString();\n","/*\r\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\r\n\r\nThis file is part of vodle.\r\n\r\nvodle is free software: you can redistribute it and/or modify it under the \r\nterms of the GNU Affero General Public License as published by the Free \r\nSoftware Foundation, either version 3 of the License, or (at your option) \r\nany later version.\r\n\r\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \r\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \r\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \r\ndetails.\r\n\r\nYou should have received a copy of the GNU Affero General Public License \r\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \r\n*/\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { ExplainApprovalPageRoutingModule } from './explain-approval-routing.module';\r\n\r\nimport { ExplainApprovalPage } from './explain-approval.page';\r\nexport { ExplainApprovalPage } from './explain-approval.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    ExplainApprovalPageRoutingModule,\r\n    TranslateModule.forChild(),\r\n    ExplainApprovalPage\r\n  ],\r\n  exports: [ExplainApprovalPage]\r\n})\r\nexport class ExplainApprovalPageModule {}\r\n","/*\r\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\r\n\r\nThis file is part of vodle.\r\n\r\nvodle is free software: you can redistribute it and/or modify it under the \r\nterms of the GNU Affero General Public License as published by the Free \r\nSoftware Foundation, either version 3 of the License, or (at your option) \r\nany later version.\r\n\r\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \r\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \r\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \r\ndetails.\r\n\r\nYou should have received a copy of the GNU Affero General Public License \r\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \r\n*/\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { ExplainApprovalPage } from './explain-approval.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ExplainApprovalPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class ExplainApprovalPageRoutingModule {}\r\n"],"names":["Component","Input","ModalController","TranslateService","GlobalService","IonicModule","TranslateModule","CommonModule","ExplainApprovalPage","constructor","modalController","translate","G","Math","ready","tab","seen_tabs","Set","tr1","tr2","td1","td2","tob1","dtt","tab2","to1","to2","text_y0_start","tspan_i_start","tspan_end","text_end","approval_font_size_small","approval_font_size_normal","approval_font_size_large","share_font_size_small","share_font_size_normal","share_font_size_large","playing","ngOnInit","p","parent","oid","rs0","T","effective_ratings_ascending_map","Map","get","rs","rmin","thresholds_map","cs","ts","poss","myr","get_my_effective_rating","n","n_not_abstaining","offset","length","dur","a","approval_scores_map","optionname","options","name","tob2","tt1","tt2","tab1","thresholdi","i","r","push","myi","indexOf","eff_unequal_proxy","get_my_proxy_rating","L","trace","nvs","vids","vm","votes_map","dattrs","myv","myvid","oids","os","ps","ss","vid","ap","approvals_map","oid2","lastss","oidsorted","thisps","sumps","index","slice","concat","share","R","pieradius","dx","sin","two_pi","dy","cos","more_than_180_degrees_flag","ionViewWillEnter","ionViewDidEnter","window","setTimeout","restart","back","close","go","forward","has","add","dismiss","svg","document","getElementById","setCurrentTime","pause","pauseAnimations","unpause","unpauseAnimations","to_end","__decorate","imports","selector","template","__NG_CLI_RESOURCE__0","NgModule","FormsModule","ExplainApprovalPageRoutingModule","ExplainApprovalPageModule","forChild","exports","RouterModule","routes","path","component"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}