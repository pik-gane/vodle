{"version":3,"file":"1353.2e341b40f747a9c2.js","mappings":"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","names":["i0","ExplainApprovalPage","constructor","modalController","translate","G","this","Math","Set","tab","ngOnInit","p","parent","oid","rs0","T","effective_ratings_ascending_map","Map","get","rs","rmin","thresholds_map","cs","ts","poss","myr","get_my_effective_rating","n","n_not_abstaining","offset","length","dur","tab2","tob1","dtt","a","approval_scores_map","optionname","options","name","tob2","tt1","tt2","tab1","thresholdi","i","r","push","myi","indexOf","eff_unequal_proxy","get_my_proxy_rating","L","trace","nvs","vids","vm","votes_map","dattrs","myv","myvid","oids","os","ps","ss","vid","ap","approvals_map","oid2","lastss","oidsorted","thisps","sumps","index","slice","concat","share","R","pieradius","dx","sin","two_pi","dy","cos","more_than_180_degrees_flag","ionViewWillEnter","seen_tabs","ionViewDidEnter","ready","window","setTimeout","restart","back","close","go","forward","has","add","dismiss","document","getElementById","setCurrentTime","pause","pauseAnimations","playing","unpause","unpauseAnimations","to_end","selectors","routes","path","component","ExplainApprovalPageRoutingModule","RouterModule","ExplainApprovalPageModule","CommonModule","FormsModule","IonicModule","TranslateModule"],"sourceRoot":"webpack:///","sources":["./src/app/explain-approval/explain-approval.page.html","./src/app/explain-approval/explain-approval.page.ts","./src/app/explain-approval/explain-approval-routing.module.ts","./src/app/explain-approval/explain-approval.module.ts"],"sourcesContent":["<!--\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n-->\n\n<!-- TODO:\n  * treat all abstaining case!\n  * remove \"you\" if abstaining\n  * how to deal with fake 100 ratings?\n-->\n\n<ion-content *ngIf=\"ready\" class=\"ion-no-margin ion-no-padding\">\n  <ion-item class=\"ion-no-margin ion-no-padding\">\n    <ion-buttons>\n      &nbsp;&nbsp;\n      <ion-button *ngIf=\"tab=='approval'\" shape=\"round\" fill=\"clear\"\n          (click)=\"back()\">\n        <ion-icon slot=\"icon-only\" name=\"close-outline\"></ion-icon>\n      </ion-button>\n      <ion-button *ngIf=\"tab=='share'\" shape=\"round\" fill=\"clear\"\n          (click)=\"back()\">\n        <ion-icon slot=\"icon-only\" name=\"arrow-back-outline\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n    <ion-label>\n      {{(tab == 'approval' ? 'explain.title-approval' : 'explain.title-share')|translate}} <b><i [lang]=\"p.language\" [innerHtml]=\"optionname\"></i></b>\n    </ion-label>\n    <ion-buttons slot=\"end\" class=\"ion-no-margin ion-no-padding\">\n      <ion-button *ngIf=\"tab=='approval'\" shape=\"round\" fill=\"clear\" class=\"ion-no-margin ion-no-padding\"\n          (click)=\"forward()\">\n        <ion-icon slot=\"icon-only\" name=\"arrow-forward-outline\"></ion-icon>\n      </ion-button>\n      <ion-button *ngIf=\"tab=='share'\" shape=\"round\" fill=\"clear\" class=\"ion-no-margin ion-no-padding\"\n          (click)=\"close()\">\n        <ion-icon slot=\"icon-only\" name=\"close-outline\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-item>\n\n  <ion-item class=\"ion-no-margin ion-no-padding\">\n    <svg id=\"animation\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" viewBox=\"-25 -25 130 160\">\n      <defs>\n        <marker id=\"arrowhead-grey\" markerWidth=\"10\" markerHeight=\"7\" \n                refX=\"0\" refY=\"3.5\" orient=\"auto\">\n          <polyline points=\"0 0, 10 3.5, 0 7\" fill=\"var(--vodle-dark)\"/>\n        </marker>\n        <marker id=\"arrowhead-green\" markerWidth=\"10\" markerHeight=\"7\" \n                refX=\"0\" refY=\"3.5\" orient=\"auto\">\n          <polyline points=\"0 0, 10 3.5, 0 7\" fill=\"black\"/><!--or var(--vodle-darkgreen) ?-->\n        </marker>\n      </defs>\n\n      <!-- APPROVAL TAB: -->\n\n      <g *ngIf=\"tab=='approval'\" font-family=\"Quicksand\" [attr.font-size]=\"approval_font_size_normal\">\n\n        <!-- ANIMATION:\n          * from sec. tr1 to tr2, the ratings come in \n          * from sec. 0 to 4, the opposition and approval bars will build from left to right / bottom to top\n          * from sec. 4 to 5, the approval bar will \"fall\" into its final horizontal position \n          * from sec. 5 to 6, the approval bar widens to full height and the opposition bar fades out\n          * at sec. 6, voter's own rating shows\n        -->\n\n        <text x=\"0\" y=\"-11\" fill=\"black\">&nbsp;<tspan [innerHtml]=\"'explain.all-ratings'|translate\"></tspan></text>\n        <text x=\"0\" y=\"-6\" fill=\"var(--vodle-grey)\">&nbsp;<tspan [innerHtml]=\"'explain.large-to-small'|translate\"></tspan></text>\n\n        <g transform=\"scale(1 -1) translate(0 -100)\">\n\n          <!-- approval bar: -->\n          <g *ngIf=\"a>0\" [attr.transform]=\"'translate('+(100*(1-a))+' '+(100*(1-a))+')'\">\n            <animateTransform attributeName=\"transform\" attributeType=\"XML\" \n                type=\"translate\" [attr.from]=\"''+(100*(1-a))+' '+(100*(1-a))\" [attr.to]=\"'100 '+poss[myi]\" [attr.begin]=\"''+to1+'s'\" [attr.dur]=\"''+(to2-to1)+'s'\" fill=\"freeze\" /><!-- move to own rating -->\n            <g transform=\"rotate(90)\"><!-- initially upwards -->\n              <animateTransform attributeName=\"transform\" attributeType=\"XML\" \n                type=\"rotate\" from=\"90\" to=\"180\" [attr.begin]=\"''+to1+'s'\" [attr.dur]=\"''+(to2-to1)+'s'\" fill=\"freeze\" /><!-- rotate to horizontal -->\n              <rect x=\"-0.5\" y=\"-2.5\" width=\"0\" height=\"5\" fill=\"var(--vodle-light)\" stroke=\"none\"><!--not:var(--vodle-green-transparent)-->\n                <animate attributeName=\"width\" \n                  from=\"0\" [attr.to]=\"0.5+100*a\" [attr.begin]=\"''+tab1+'s'\" [attr.dur]=\"''+(tab2-tab1)+'s'\" fill=\"freeze\" />\n              </rect>\n              <line display=\"none\" x1=\"-0.5\" y1=\"-5\" x2=\"-0.5\" y2=\"5\" stroke=\"var(--vodle-light)\" stroke-width=\"0.5\">\n                <set attributeName=\"display\" to=\"inline\" [attr.begin]=\"''+tab1+'s'\" />\n              </line>\n            </g>\n          </g>\n\n          <!-- left vertical: -->\n          <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"115\" stroke-width=\"0.2\" stroke=\"var(--vodle-border-grey)\" stroke-dasharray=\"3 2\" />\n\n          <!-- rating needles: -->\n          <g transform=\"scale(0 1)\"><!-- initially zero width -->\n            <animateTransform attributeName=\"transform\" attributeType=\"XML\" \n              type=\"scale\" from=\"0 1\" to=\"1 1\" [attr.begin]=\"''+tr1+'s'\" [attr.dur]=\"''+(tr2-tr1)+'s'\" fill=\"freeze\" /><!-- grow to real width -->\n            <line *ngFor=\"let item of rs; let i = index\" \n                  stroke-width=\"0.5\"\n                  [attr.y1]=\"poss[i]\" [attr.y2]=\"poss[i]\" x1=\"0\" [attr.x2]=\"rs[i]\" stroke=\"black\">\n              <set attributeName=\"stroke\" [attr.to]=\"cs[i]\" [attr.begin]=\"ts[i]\" />\n            </line>\n            <circle *ngFor=\"let item of rs; let i = index\"\n                  [attr.cy]=\"poss[i]\" [attr.cx]=\"rs[i]\" r=\"0.75\" fill=\"black\">\n              <set attributeName=\"fill\" [attr.to]=\"cs[i]\" [attr.begin]=\"ts[i]\" />\n            </circle>\n          </g>\n\n          <!-- diagonal: -->\n          <line opacity=\"0\" x1=\"-4\" y1=\"-5\" x2=\"106\" y2=\"105\" stroke-width=\"0.2\" stroke=\"var(--vodle-border-grey)\" stroke-dasharray=\"3 2\">\n            <animate attributeName=\"opacity\" \n              from=\"0\" to=\"1\" [attr.begin]=\"''+td1+'s'\" [attr.dur]=\"''+(td2-td1)+'s'\" fill=\"freeze\" /><!-- fade in -->\n          </line>\n\n          <!-- first approving needle: -->\n          <line stroke-width=\"0\"\n            [attr.y1]=\"poss[thresholdi]\" [attr.y2]=\"poss[thresholdi]\" x1=\"0\" [attr.x2]=\"rs[thresholdi]\" [attr.stroke]=\"cs[thresholdi]\">\n            <animate attributeName=\"stroke-width\" \n              from=\"5\" to=\"0\" [attr.begin]=\"''+tt1+'s'\" [attr.dur]=\"''+(tt2-tt1)+'s'\" fill=\"freeze\" />\n          </line>\n\n          <!-- small approval label: -->\n          <g *ngIf=\"a>0\" display=\"none\" [attr.transform]=\"'translate('+(100*(1-a))+','+(100*(1-a))+')'\">\n            <set attributeName=\"display\" to=\"inline\" [attr.begin]=\"''+tab1+'s'\" /><!---->\n            <animate attributeName=\"opacity\" \n              from=\"1\" to=\"0\" [attr.begin]=\"''+to1+'s'\" [attr.dur]=\"''+(to2-to1)+'s'\" fill=\"freeze\" /><!-- fade out -->\n            <g transform=\"rotate(90)\">\n              <g transform=\"translate(0, -1.25) scale(1 -1)\">\n                <text fill=\"black\">&nbsp;<tspan [innerHtml]=\"'explain.vertical-approval-label'|translate\"></tspan></text>\n              </g>\n            </g>\n          </g>\n\n          <!-- final elements: -->\n          <g opacity=\"0\">\n            <animate attributeName=\"opacity\" \n              from=\"0\" to=\"1\" [attr.begin]=\"''+to1+'s'\" [attr.dur]=\"''+(to2-to1)+'s'\" fill=\"freeze\" />\n            <!-- approval bar -->\n            <g display=\"none\" [attr.transform]=\"'translate(100 '+poss[myi]+') rotate(180)'\">\n              <set attributeName=\"display\" to=\"inline\" [attr.begin]=\"''+to2+'s'\"></set>\n              <rect x=\"-0.5\" y=\"-2.5\" [attr.width]=\"0.5+100*a\" height=\"5\" fill=\"var(--vodle-light)\" stroke=\"none\"><!--not:var(--vodle-green-transparent)-->\n              </rect>\n              <line x1=\"-0.5\" y1=\"-5\" x2=\"-0.5\" y2=\"5\" stroke=\"var(--vodle-light)\" stroke-width=\"0.5\">\n              </line>\n            </g>\n            <!-- threshold vertical: -->\n            <line [attr.x1]=\"100*(1-a)\" [attr.x2]=\"100*(1-a)\" y1=\"-26\" y2=\"101\" stroke-width=\"0.2\" stroke=\"var(--vodle-border-grey)\" stroke-dasharray=\"3 2\" />\n            <!-- own rating marker: -->\n            <ng-container *ngIf=\"!!myv\">\n              <line stroke-width=\"2\" \n                  [attr.y1]=\"poss[myi]\" [attr.y2]=\"poss[myi]\" x1=\"0\" [attr.x2]=\"myr\" [attr.stroke]=\"cs[myi]\" />\n              <circle [attr.cy]=\"poss[myi]\" [attr.cx]=\"rs[myi]\" r=\"3\" [attr.fill]=\"cs[myi]\" />\n            </ng-container>\n            <!-- final annotations: -->\n            <g transform=\"scale(1 -1)\" fill=\"black\">\n              <g *ngIf=\"a<1\">\n                <text [attr.x]=\"100*(1-a)\" y=\"10\" fill=\"var(--vodle-blue)\" text-anchor=\"end\"><tspan [innerHtml]=\"'explain.threshold-smaller-line-1'|translate\"></tspan>&nbsp;&nbsp;</text>\n                <text [attr.x]=\"100*(1-a)\" y=\"15\" fill=\"var(--vodle-blue)\" text-anchor=\"end\"><tspan [innerHtml]=\"'explain.threshold-smaller-line-2'|translate\"></tspan>&nbsp;&nbsp;</text>\n                <text [attr.x]=\"100*(1-a)\" y=\"20\" fill=\"var(--vodle-blue)\" text-anchor=\"end\"><tspan [innerHtml]=\"'explain.threshold-smaller-line-3'|translate\"></tspan>&nbsp;&nbsp;</text>\n                <text [attr.x]=\"100*(1-a)\" y=\"25\" fill=\"var(--vodle-blue)\" text-anchor=\"end\"><tspan [innerHtml]=\"'explain.threshold-smaller-line-4'|translate\"></tspan>&nbsp;&nbsp;</text>\n              </g>\n              <g *ngIf=\"a>0\">\n                <text [attr.x]=\"100*(1-a)\" y=\"10\" fill=\"var(--vodle-green)\">&nbsp;&nbsp;<tspan [innerHtml]=\"'explain.threshold-larger-line-1'|translate\"></tspan></text>\n                <text [attr.x]=\"100*(1-a)\" y=\"15\" fill=\"var(--vodle-green)\">&nbsp;&nbsp;<tspan [innerHtml]=\"'explain.threshold-larger-line-2'|translate\"></tspan></text>\n                <text [attr.x]=\"100*(1-a)\" y=\"20\" fill=\"var(--vodle-green)\">&nbsp;&nbsp;<tspan [innerHtml]=\"'explain.threshold-larger-line-3'|translate\"></tspan></text>\n                <text [attr.x]=\"100*(1-a)\" y=\"25\" fill=\"var(--vodle-green)\">&nbsp;&nbsp;<tspan [innerHtml]=\"'explain.threshold-larger-line-4'|translate\"></tspan></text>\n              </g>\n              <g [attr.transform]=\"'translate(0 '+(-poss[myi])+')'\" font-weight=\"bold\">\n                <ng-container *ngIf=\"!!myv\">\n                  <text x=\"0\" y=\"-1\" [attr.fill]=\"cs[myi]\" text-anchor=\"end\"><tspan [innerHtml]=\"'explain.your-rating-line-1'|translate\"></tspan>&nbsp;&nbsp;</text>\n                  <text x=\"0\" y=\"4\" [attr.fill]=\"cs[myi]\" text-anchor=\"end\"><tspan [innerHtml]=\"'explain.your-rating-line-2'|translate\"></tspan><tspan *ngIf=\"eff_unequal_proxy\">*</tspan>&nbsp;&nbsp;</text>\n                </ng-container>\n                <g [attr.transform]=\"poss[myi] >= 13 ? 'translate(0 20)' : ''\">\n                  <!-- backdrop: -->\n                  <rect x=\"75\" y=\"-16\" width=\"25\" height=\"13\" fill=\"var(--vodle-white-semi)\"></rect>\n                  <text x=\"100\" y=\"-9.5\" fill=\"var(--vodle-dark)\" text-anchor=\"end\"><tspan [attr.font-size]=\"approval_font_size_large\" font-weight=\"bold\">{{(a*100).toFixed(1)}}%</tspan>&nbsp;</text>\n                  <text x=\"100\" y=\"-4.5\" fill=\"var(--vodle-dark)\" text-anchor=\"end\"><tspan [innerHtml]=\"'explain.horizontal-approval-label'|translate\"></tspan>&nbsp;</text>\n                </g>\n              </g>\n              <g *ngIf=\"!!myv && eff_unequal_proxy\" [attr.font-size]=\"approval_font_size_small\" fill=\"var(--vodle-grey)\">\n                <text x=\"-20\" y=\"31\">*<tspan [innerHtml]=\"'explain.largest-line-1'|translate\"></tspan></text>\n                <text x=\"-20\" y=\"34\">&nbsp;<tspan [innerHtml]=\"'explain.largest-line-2'|translate\"></tspan></text>\n              </g>\n            </g>\n          </g>\n    \n          <!-- opposition bar and label: -->\n          <g *ngIf=\"a<1\" transform=\"rotate(45) translate(0, 7)\">\n            <animate attributeName=\"opacity\" \n              from=\"1\" to=\"0\" [attr.begin]=\"''+to1+'s'\" [attr.dur]=\"''+(to2-to1)+'s'\" fill=\"freeze\" /><!-- fade out -->\n            <g transform=\"scale(1.4142, 1)\">\n              <rect [attr.x]=\"0\" y=\"-12.5\" width=\"0\" height=\"5\" fill=\"var(--vodle-blue-transparent)\" stroke=\"none\">\n                <animate attributeName=\"width\" \n                  from=\"0\" [attr.to]=\"100*(1-a)-0.5\" [attr.begin]=\"''+tob1+'s'\" [attr.dur]=\"''+(tob2-tob1)+'s'\" fill=\"freeze\" />\n              </rect>\n            </g>\n            <g display=\"none\">\n              <set attributeName=\"display\" to=\"inline\" [attr.begin]=\"''+tob1+'s'\" />\n              <line x1=\"0\" y1=\"-15\" x2=\"0\" y2=\"-5\" stroke=\"var(--vodle-blue-transparent)\" stroke-width=\"0.5\">\n              </line>\n              <g transform=\"translate(0, -11.25) scale(1 -1)\" >\n                <text fill=\"black\">&nbsp;<tspan [innerHtml]=\"'explain.opposition'|translate\"></tspan></text>\n              </g>   \n            </g>\n          </g>\n\n        </g>\n      </g>\n\n      <!-- SHARE TAB: -->\n\n      <g *ngIf=\"tab=='share'\" font-family=\"Quicksand\" [attr.font-size]=\"share_font_size_normal\">\n\n        <!-- TODO:\n          * fade black arrows and explanation to grey\n        -->\n\n        <ng-container *ngIf=\"n == 0\">\n            \n          <!-- ALL ABSTAIN -->\n\n          <g transform=\"translate(-14 -4)\">\n            <!-- text: -->\n            <text y=\"-13\" [innerHtml]=\"'explain.all-abstain-line-1'|translate\">\n            </text>\n            <text y=\"-8\">\n              {{'explain.all-abstain-line-2-before-percentage'|translate}}<tspan font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.font-size]=\"share_font_size_large\">{{(100/p.oids.length).toFixed(1)}}%</tspan>{{'explain.all-abstain-line-2-after-percentage'|translate}}\n            </text>\n          </g>\n\n        </ng-container>\n        <ng-container *ngIf=\"n > 0\">\n\n          <!-- NOT ALL ABSTAIN -->\n            \n          <!-- intro: -->\n          <g transform=\"translate(-14 -4)\">\n            <!-- text: -->\n            <g opacity=\"0\">\n              <animate attributeName=\"opacity\" \n                from=\"0\" to=\"1\" begin=\"0s\" dur=\"1s\" fill=\"freeze\" /><!-- fade in -->\n              <text y=\"-13\" fill=\"var(--vodle-medium)\" [innerHtml]=\"'explain.share-intro-line-1'|translate\">\n              </text>\n              <text y=\"-8\" fill=\"var(--vodle-medium)\" [innerHtml]=\"'explain.share-intro-line-2'|translate\">\n              </text>\n            </g>\n            <g opacity=\"0\">\n              <animate attributeName=\"opacity\" \n                from=\"0\" to=\"1\" begin=\"3s\" dur=\"1s\" fill=\"freeze\" /><!-- fade in -->\n              <ng-container *ngIf=\"a == 0\">\n                <text y=\"0\" [innerHtml]=\"'explain.zero-line-1'|translate\">\n                </text>\n                <text y=\"5\" [innerHtml]=\"'explain.zero-line-2'|translate\">\n                </text>\n              </ng-container>\n              <ng-container *ngIf=\"a > 0\">\n                <ng-container *ngIf=\"ps.length != 1\">\n                  <ng-container *ngIf=\"ps[ps.length-1] == 0\">\n                    <text y=\"0\" [innerHtml]=\"'explain.all-line-1'|translate:{percentage:(a*100).toFixed(1)}\">\n                    </text>\n                    <text y=\"5\" [innerHtml]=\"'explain.all-line-2'|translate:{percentage:(a*100).toFixed(1)}\">\n                    </text>\n                  </ng-container>\n                  <ng-container *ngIf=\"ps[ps.length-1] > 0\">\n                    <text y=\"0\" [innerHtml]=\"'explain.some-line-1'|translate:{percentage:(a*100).toFixed(1)}\">\n                    </text>\n                    <text y=\"5\" [innerHtml]=\"'explain.some-line-2'|translate:{percentage:(a*100).toFixed(1)}\">\n                    </text>\n                  </ng-container>\n                </ng-container>\n                <ng-container *ngIf=\"ps.length == 1\">\n                  <text y=\"0\" [innerHtml]=\"'explain.no-one-line-1'|translate:{percentage:(a*100).toFixed(1)}\">\n                  </text>\n                  <text y=\"5\" [innerHtml]=\"'explain.no-one-line-2'|translate:{percentage:(a*100).toFixed(1)}\">\n                  </text>\n                </ng-container>\n              </ng-container>\n            </g>\n          </g>\n\n          <!-- bottom row approval bar: -->\n          <g transform=\"translate(0 15)\" opacity=\"0\">\n            <animate attributeName=\"opacity\" \n              from=\"0\" to=\"1\" begin=\"3s\" dur=\"1s\" fill=\"freeze\" /><!-- fade in -->\n            <animateTransform attributeName=\"transform\" attributeType=\"XML\" \n              type=\"translate\" [attr.from]=\"'0 15'\" [attr.to]=\"'0 '+(20+15*os.length)\" begin=\"5s\" dur=\"1s\" fill=\"freeze\" /><!-- move to bottom -->\n          \n            <rect [attr.x]=\"100*(1-a)\" y=\"-2.5\" [attr.width]=\"0.5+100*a\" height=\"5\" fill=\"var(--vodle-light)\" stroke=\"none\">\n            </rect>\n            <line x1=\"100.5\" y1=\"-5\" x2=\"100.5\" y2=\"5\" stroke=\"var(--vodle-light)\" stroke-width=\"0.5\">\n            </line>\n            <text x=\"100\" y=\"8\" fill=\"var(--vodle-dark)\" text-anchor=\"end\"><tspan font-weight=\"bold\">{{(a*100).toFixed(1)}}%</tspan>&nbsp;</text>\n            <text x=\"100\" y=\"13\" fill=\"var(--vodle-dark)\" text-anchor=\"end\"><tspan [innerHtml]=\"'explain.horizontal-approval-label'|translate\"></tspan>&nbsp;</text>\n          </g>\n\n          <!-- higher-up options' rows: -->\n          <g *ngFor=\"let item of [].constructor(os.length-1); let i = index\" \n              [attr.transform]=\"'translate(0 '+(15+15*i)+')'\" \n              opacity=\"0\">\n            <animate attributeName=\"opacity\" \n              from=\"0\" to=\"1\" [attr.begin]=\"''+(6+3*i)+'s'\" dur=\"1s\" fill=\"freeze\" /><!-- fade in -->\n\n            <!-- other option's pie chart: -->\n            <g transform=\"translate(-10 0) scale(.3 .3)\">\n              <circle cx=\"0\" cy=\"0\" r=\"20\" fill=\"var(--vodle-light)\" stroke=\"none\" />\n              <path id=\"_pie_other\" [attr.d]=\"dattrs[i]\" fill=\"var(--vodle-dark)\" />  \n            </g>\n\n            <!-- explanation: -->\n            <g transform=\"translate(0 -1)\" fill=\"var(--vodle-medium)\">\n              <!-- backdrop: -->\n              <rect x=\"-1\" y=\"-4\" width=\"140\" height=\"9\" fill=\"var(--vodle-white)\"></rect>\n              <!-- text: -->\n              <ng-container *ngIf=\"ps.length == 2 && myv != oids[i]\">\n                <text y=\"0\">\n                  {{('explain.only-higher-line-1-before-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}<tspan font-style=\"italic\" [attr.lang]=\"p.language\">{{os[i]}}</tspan>{{('explain.only-higher-line-1-after-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}\n                </text>\n                <text y=\"5\" [innerHtml]=\"'explain.only-higher-line-2'|translate\">\n                </text>\n              </ng-container> \n              <ng-container *ngIf=\"ps.length == 2 && myv == oids[i]\">\n                <text y=\"0\">\n                  {{('explain.only-higher-incl-you-line-1-before-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}<tspan font-style=\"italic\" [attr.lang]=\"p.language\">{{os[i]}}</tspan>{{('explain.only-higher-incl-you-line-1-after-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}\n                </text>\n                <text y=\"5\" [innerHtml]=\"'explain.only-higher-incl-you-line-2'|translate\">\n                </text>\n              </ng-container> \n              <ng-container *ngIf=\"ps.length != 2 && i == 0 && myv != oids[i]\">\n                <text y=\"0\">\n                  {{('explain.among-them-line-1-before-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}<tspan font-style=\"italic\" [attr.lang]=\"p.language\">{{os[i]}}</tspan>{{('explain.among-them-line-1-after-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}\n                </text>\n                <text y=\"5\" [innerHtml]=\"'explain.among-them-line-2'|translate\">\n                </text>\n              </ng-container> \n              <ng-container *ngIf=\"ps.length != 2 && i == 0 && myv == oids[i]\">\n                <text y=\"0\">\n                  {{('explain.among-them-incl-you-line-1-before-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}<tspan font-style=\"italic\" [attr.lang]=\"p.language\">{{os[i]}}</tspan>{{('explain.among-them-incl-you-line-1-after-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}\n                </text>\n                <text y=\"5\" [innerHtml]=\"'explain.among-them-incl-you-line-2'|translate\">\n                </text>\n              </ng-container> \n              <ng-container *ngIf=\"ps.length != 2 && i > 0 && myv != oids[i]\">\n                <text y=\"0\">\n                  {{('explain.another-line-1-before-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}<tspan font-style=\"italic\" [attr.lang]=\"p.language\">{{os[i]}}</tspan>{{('explain.another-line-1-after-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}\n                </text>\n                <text y=\"5\" [innerHtml]=\"'explain.another-line-2'|translate\">\n                </text>\n              </ng-container> \n              <ng-container *ngIf=\"ps.length != 2 && i > 0 && myv == oids[i]\">\n                <text y=\"0\">\n                  {{('explain.another-incl-you-line-1-before-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}<tspan font-style=\"italic\" [attr.lang]=\"p.language\">{{os[i]}}</tspan>{{('explain.another-incl-you-line-1-after-optionname'|translate:{percentage:(ps[i]*100).toFixed(1)})}}\n                </text>\n                <text y=\"5\" [innerHtml]=\"'explain.another-incl-you-line-2'|translate\">\n                </text>\n              </ng-container> \n              <!-- TODO: further cases: 0 approval; all-abstention -->\n            </g>\n\n            <!-- arrow: -->\n            <line [attr.x1]=\"100*(1-ss[i]-ps[i]/2)\" x2=\"-4\" [attr.y1]=\"4+(os.length-i)*15\" y2=\"4.8\" marker-end=\"url(#arrowhead-grey)\" stroke=\"var(--vodle-medium)\" stroke-width=\"0.2\" stroke-dasharray=\".5 .5\">\n            </line>\n\n            <!-- approval share: -->\n            <rect [attr.x]=\"100*(1-ss[i+1])+0.2\" [attr.y]=\"4+(os.length-i)*15\" [attr.width]=\"100*ps[i]-0.4\" height=\"2\" fill=\"var(--vodle-dark)\" stroke=\"none\">\n            </rect>\n\n          </g>\n\n          <!-- bottom row: -->\n          <g [attr.transform]=\"'translate(0 '+(20+15*os.length)+')'\" opacity=\"0\">\n            <animate attributeName=\"opacity\" \n              from=\"0\" to=\"1\" [attr.begin]=\"''+(6+3*(ps.length-1))+'s'\" dur=\"1s\" fill=\"freeze\" /><!-- fade in -->\n\n            <!-- explanation: -->\n            <g transform=\"translate(-14 -17)\">\n              <!-- backdrop: -->\n              <rect x=\"-10\" y=\"-4\" width=\"140\" height=\"10\" fill=\"var(--vodle-white)\"></rect>\n              <!-- text: -->\n              <ng-container *ngIf=\"ps.length == 1 && myv != oid\">\n                <text y=\"0\">\n                  {{'explain.whole-share-line-1-before-percentage'|translate}}<tspan font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.font-size]=\"share_font_size_large\">{{(ps[ps.length-1]*100).toFixed(1)}}%</tspan>{{'explain.whole-share-line-1-after-percentage'|translate}}\n                </text>\n                <text y=\"5\">\n                  {{'explain.whole-share-line-2-before-optionname'|translate}}<tspan font-style=\"italic\" font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.lang]=\"p.language\">{{optionname}}</tspan>{{'explain.whole-share-line-2-after-optionname'|translate}}\n                </text>\n              </ng-container> \n              <ng-container *ngIf=\"ps.length == 1 && myv == oid\">\n                <text y=\"0\">\n                  {{'explain.whole-share-incl-you-line-1-before-percentage'|translate}}<tspan font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.font-size]=\"share_font_size_large\">{{(ps[ps.length-1]*100).toFixed(1)}}%</tspan>{{'explain.whole-share-incl-you-line-1-after-percentage'|translate}}\n                </text>\n                <text y=\"5\">\n                  {{'explain.whole-share-incl-you-line-2-before-optionname'|translate}}<tspan font-style=\"italic\" font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.lang]=\"p.language\">{{optionname}}</tspan>{{'explain.whole-share-incl-you-line-2-after-optionname'|translate}}\n                </text>\n              </ng-container> \n              <ng-container *ngIf=\"ps.length > 1 && ps[ps.length-1] > 0 && myv != oid\">\n                <text y=\"0\">\n                  {{'explain.remaining-line-1-before-percentage'|translate}}<tspan font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.font-size]=\"share_font_size_large\">{{(ps[ps.length-1]*100).toFixed(1)}}%</tspan>{{'explain.remaining-line-1-after-percentage'|translate}}\n                </text>\n                <text y=\"5\">\n                  {{'explain.remaining-line-2-before-optionname'|translate}}<tspan font-style=\"italic\" font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.lang]=\"p.language\">{{optionname}}</tspan>{{'explain.remaining-line-2-after-optionname'|translate}}\n                </text>\n              </ng-container> \n              <ng-container *ngIf=\"ps.length > 1 && ps[ps.length-1] > 0 && myv == oid\">\n                <text y=\"0\">\n                  {{'explain.remaining-incl-you-line-1-before-percentage'|translate}}<tspan font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.font-size]=\"share_font_size_large\">{{(ps[ps.length-1]*100).toFixed(1)}}%</tspan>{{'explain.remaining-incl-you-line-1-after-percentage'|translate}}\n                </text>\n                <text y=\"5\">\n                  {{'explain.remaining-incl-you-line-2-before-optionname'|translate}}<tspan font-style=\"italic\" font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.lang]=\"p.language\">{{optionname}}</tspan>{{'explain.remaining-incl-you-line-2-after-optionname'|translate}}\n                </text>\n              </ng-container> \n              <ng-container *ngIf=\"ps.length > 1 && ps[ps.length-1] == 0\">\n                <text y=\"0\">\n                  {{'explain.nothing-left-line-1-before-percentage'|translate}}<tspan font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.font-size]=\"share_font_size_large\">0%</tspan>{{'explain.nothing-left-line-1-after-percentage'|translate}}\n                </text>\n                <text y=\"5\">\n                  {{'explain.nothing-left-line-2-before-optionname'|translate}}<tspan font-style=\"italic\" font-weight=\"bold\" fill=\"var(--vodle-darkgreen)\" [attr.lang]=\"p.language\">{{optionname}}</tspan>{{'explain.nothing-left-line-2-after-optionname'|translate}}\n                </text>\n              </ng-container> \n            </g>\n\n            <!-- this option's pie chart: -->\n            <g transform=\"translate(-10 0) scale(.45 .45)\">\n              <circle cx=\"0\" cy=\"0\" r=\"20\" fill=\"var(--vodle-light)\" stroke=\"none\" />\n              <path id=\"_pie_own\" [attr.d]=\"dattrs[dattrs.length-1]\" fill=\"var(--vodle-darkgreen)\" />  \n            </g>\n            <ng-container *ngIf=\"ps[ps.length-1] > 0\">\n\n              <!-- arrow: -->\n              <line [attr.x1]=\"100*(1-a)\" x2=\"-4\" y1=\"0\" y2=\"0\" marker-end=\"url(#arrowhead-green)\" stroke=\"black\" stroke-width=\"0.2\" stroke-dasharray=\".5 .5\"><!--or var(--vodle-darkgreen)?-->\n              </line>\n\n              <!-- approval share: -->\n              <rect [attr.x]=\"100*(1-a)+0.2\" y=\"-1\" [attr.width]=\"100*ps[ps.length-1]-0.4\" height=\"2\" fill=\"var(--vodle-darkgreen)\" stroke=\"none\">\n              </rect>\n            </ng-container>\n          </g>\n        </ng-container>\n\n      </g>\n      \n    </svg>\n  </ion-item>\n\n  <!-- animation play controls:-->\n\n  <ion-item lines=\"none\" class=\"ion-text-center\">\n    <ion-col></ion-col>\n    <ion-col size=\"auto\">\n      <ion-buttons class=\"ion-no-margin ion-no-padding\">\n        <ion-button shape=\"round\" fill=\"clear\" class=\"ion-no-margin ion-no-padding\"\n            (click)=\"restart()\">\n          <ion-icon slot=\"icon-only\" name=\"reload-outline\"></ion-icon>\n        </ion-button>\n        <ion-button *ngIf=\"playing\" shape=\"round\" fill=\"clear\" class=\"ion-no-margin ion-no-padding\"\n            (click)=\"pause()\">\n          <ion-icon slot=\"icon-only\" name=\"pause-outline\"></ion-icon>\n        </ion-button>\n        <ion-button *ngIf=\"!playing\" shape=\"round\" fill=\"clear\" class=\"ion-no-margin ion-no-padding\"\n            (click)=\"unpause()\">\n          <ion-icon slot=\"icon-only\" name=\"play-outline\"></ion-icon>\n        </ion-button>\n        <ion-button shape=\"round\" fill=\"clear\" class=\"ion-no-margin ion-no-padding\"\n            (click)=\"to_end()\">\n          <ion-icon slot=\"icon-only\" name=\"play-skip-forward-outline\"></ion-icon>\n        </ion-button>\n      </ion-buttons>\n    </ion-col>\n    <ion-col></ion-col>\n  </ion-item>\n\n</ion-content>\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { Component, OnInit, Input } from '@angular/core';\nimport { ModalController } from '@ionic/angular';\nimport { TranslateService } from '@ngx-translate/core';\n\nimport { GlobalService } from \"../global.service\";\nimport { PollPage } from '../poll/poll.module';  \nimport { Poll } from '../poll.service';\n\n@Component({\n  selector: 'app-explain-approval',\n  templateUrl: './explain-approval.page.html',\n  styleUrls: ['./explain-approval.page.scss'],\n})\nexport class ExplainApprovalPage implements OnInit {\n\n  Math = Math;\n\n  @Input() parent: PollPage;\n  @Input() oid: string;\n\n  ready = false;\n  tab = \"approval\";\n  seen_tabs = new Set([this.tab]);\n\n  p: Poll;\n  optionname: string;\n\n  // data for approval animation:\n\n  rs: number[];\n  rmin: number;\n  a: number;\n  cs: string[];\n  ts: string[];\n  n: number;\n  myr: number;\n  myi: number;\n  myv: string;\n  thresholdi: number;\n  poss: number[];\n  // timing:\n  tr1 = 0; tr2 = 2;  // ratings needles\n  td1 = 2; td2 = 4;  // diagonal\n  tob1 = 4; tob2: number;  // opposition bar\n  dtt = 1; tt1: number; tt2: number;  // threshold\n  tab1: number; tab2 = 7;  // approval bar\n  to1 = 8; to2 = 9;  // own status\n  eff_unequal_proxy: boolean;\n\n  // data for share animation:\n  oids: string[];\n  os: string[];\n  ps: number[];\n  ss: number[];\n  dattrs: string[];\n\n  // svg code snippets:\n\n  text_y0_start = '<text y=\"0\">';\n  tspan_i_start = '<tspan font-style=\"italic\">';\n  tspan_end = '</tspan>';\n  text_end = '</text>'; \n\n  // styling:\n  approval_font_size_small = 3;\n  approval_font_size_normal = 3.75;\n  approval_font_size_large = 6;\n  share_font_size_small = 3;\n  share_font_size_normal = 3.75;\n  share_font_size_large = 6;\n\n\n  constructor(\n    private modalController: ModalController,\n    translate: TranslateService,\n    G: GlobalService) { \n  }\n\n  ngOnInit() {\n    // approval:\n    const p = this.p = this.parent.p,\n          oid = this.oid,\n          rs0 = (p.T.effective_ratings_ascending_map||new Map()).get(oid)||[],\n          rs = this.rs = [],\n          rmin = this.rmin = p.T.thresholds_map.get(oid) || 100,\n          cs = this.cs = [],\n          ts = this.ts = [],\n          poss = this.poss = [],\n          myr = this.myr = p.get_my_effective_rating(oid),\n          n = this.n = p.T.n_not_abstaining,\n          offset = n - rs0.length,\n          dur = this.tab2 - this.tob1 - this.dtt,\n          a = this.a = ((n>0) ? (p.T.approval_scores_map.get(oid) / n) : 0) || 0;\n    this.optionname = p.options[oid].name;\n    this.tob2 = this.tt1 = this.tob1 + dur*(1-a);\n    this.tt2 = this.tab1 = this.tt1 + this.dtt;\n    this.thresholdi = -1;\n    for (let i=0; i<n; i++) {\n      let r = i < offset ? 0 : rs0[i-offset];\n      rs.push(r);\n      cs.push((r == 0) ? 'var(--vodle-red)' : (r < rmin) ? 'var(--vodle-blue)' : 'var(--vodle-green)');\n      ts.push(''+(this.tob1 + dur*i/n + (r < rmin ? 0 : this.dtt))+'s' )\n      poss.push(100*(i+.01)/n);\n      if (this.thresholdi < 0 && r >= rmin) {\n        this.thresholdi = i;\n      }\n    }\n    this.myi = rs.indexOf(myr);\n    this.eff_unequal_proxy = (myr != p.get_my_proxy_rating(oid));\n\n    this.parent.G.L.trace(\"ANIMATION:\",oid,rs,rmin,cs,myr,n,this.myi,this.a,poss,this.thresholdi);\n    this.parent.G.L.trace(\"ANIMATION:\",dur, this.tob2, this.tt2);\n\n    // share:\n    const nvs = {},\n          vids = [],\n          vm = p.T.votes_map,\n          dattrs = this.dattrs = [];\n    this.myv = vm.get(p.myvid);\n    let oids = this.oids = [],\n        os = this.os = [],\n        ps = this.ps = [],\n        ss = this.ss = [];\n    for (const [vid, ap] of p.T.approvals_map.get(oid)) {\n      if (ap) {\n        vids.push(vid);\n      }\n    }\n    for (const vid of vids) {\n      // find no. of voters who vote for oid2 instead of for oid\n      const oid2 = vm.get(vid);\n      if (!(oid2 in nvs)) {\n        nvs[oid2] = 0;\n      }\n      nvs[oid2]++;\n    }\n    this.parent.G.L.trace(\"partial share:\", vids, nvs);\n    let lastss = 0;\n    for (const oid2 of this.parent.oidsorted) {\n      if (oid2 in nvs || oid2 == oid) {\n        oids.push(oid2);\n        os.push(p.options[oid2].name);\n        const thisps = (n > 0) ? ((nvs[oid2] || 0) / n) : (1 / this.parent.oidsorted.length);\n        ps.push(thisps);\n        ss.push(lastss);\n        this.parent.G.L.trace(\"partial share:\", oid2, thisps, lastss);\n        lastss += thisps;\n      }\n      if (oid2 == oid) {\n        break; // since later options can't get votes from approvers of oid\n      }\n    }\n    if (os.length > 6) {\n      // need to summarize the last few!\n      let sumps = 0;\n      for (let index=4; index<os.length-1; index++) {\n        sumps += ps[index];\n      }\n      oids = this.oids = oids.slice(0, 4).concat(['', oids[-1]]);\n      os = this.os = os.slice(0, 4).concat(['other higher-ranked options', os[-1]]);\n      ps = this.ps = ps.slice(0, 4).concat([sumps, ps[-1]]);\n      ss = this.ss = ss.slice(0, 5).concat([ss[-1]]);\n    }\n    for (const i in ps) {\n      const share = ps[i],\n            R = this.parent.pieradius,\n            dx = R * Math.sin(this.parent.two_pi * share),\n            dy = R * (1 - Math.cos(this.parent.two_pi * share)),\n            more_than_180_degrees_flag = share > 0.5 ? 1 : 0;\n      if (share < 1) {\n        dattrs.push(\"M 0,0 l 0,-\"+R+\" a \"+R+\" \"+R+\" 0 \"+more_than_180_degrees_flag+\" 1 \"+dx+\" \"+dy+\" Z\");\n      } else { // a full circle\n        dattrs.push('d', \"M 0,0 l 0,-20 a 20 20 0 1 1 0 \"+(2*R)+\" a 20 20 0 1 1 0 \"+(-2*R)+\" Z\");\n      }\n    }\n  }\n\n  ionViewWillEnter() {\n    this.tab = \"approval\";\n    this.seen_tabs = new Set([this.tab]);\n  }\n  \n  ionViewDidEnter() {\n    this.ready = true;\n    window.setTimeout(this.restart, 100);\n  }\n\n  // top-row navigation:\n\n  back() {\n    if (this.tab=='approval') {\n      this.close();\n    } else {\n      this.go('approval');\n    }\n  }\n\n  forward() {\n    this.go('share');\n  }\n\n  go(tab: string) {\n    this.tab = tab;\n    if (!this.seen_tabs.has(tab)) {\n      this.seen_tabs.add(tab);\n      this.restart();\n    }\n  }\n\n  close()\n  {\n    this.modalController.dismiss();\n  }\n\n  // bottom-row controls:\n\n  restart() {\n    const svg = <SVGSVGElement><unknown>document.getElementById(\"animation\");\n    svg.setCurrentTime(0); \n  }\n\n  playing = true;\n\n  pause() {\n    const svg = <SVGSVGElement><unknown>document.getElementById(\"animation\");\n    svg.pauseAnimations();\n    this.playing = false;\n  }\n\n  unpause() {\n    const svg = <SVGSVGElement><unknown>document.getElementById(\"animation\");\n    svg.unpauseAnimations();\n    this.playing = true;\n  }\n\n  to_end() {\n    const svg = <SVGSVGElement><unknown>document.getElementById(\"animation\");\n    svg.setCurrentTime(100); \n  }\n\n}\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ExplainApprovalPage } from './explain-approval.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ExplainApprovalPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ExplainApprovalPageRoutingModule {}\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ExplainApprovalPageRoutingModule } from './explain-approval-routing.module';\n\nimport { ExplainApprovalPage } from './explain-approval.page';\nexport { ExplainApprovalPage } from './explain-approval.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ExplainApprovalPageRoutingModule,\n    TranslateModule.forChild()\n  ],\n  declarations: [ExplainApprovalPage],\n  exports: [ExplainApprovalPage]\n})\nexport class ExplainApprovalPageModule {}\n"],"x_google_ignoreList":[]}