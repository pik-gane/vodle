{"version":3,"file":"src_app_joinpoll_joinpoll_module_ts.js","mappings":"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","sources":["./src/app/joinpoll/joinpoll-routing.module.ts","./src/app/joinpoll/joinpoll.module.ts","./src/app/joinpoll/joinpoll.page.ts"],"sourcesContent":["/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { JoinpollPage } from './joinpoll.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: JoinpollPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class JoinpollPageRoutingModule {}\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { JoinpollPageRoutingModule } from './joinpoll-routing.module';\n\nimport { JoinpollPage } from './joinpoll.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    JoinpollPageRoutingModule,\n    TranslateModule.forChild()\n  ],\n  declarations: [JoinpollPage]\n})\nexport class JoinpollPageModule {}\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { TranslateService } from '@ngx-translate/core';\n\nimport { GlobalService } from \"../global.service\";\nimport { Poll } from '../poll.service';\n\n@Component({\n  selector: 'app-join',\n  templateUrl: './joinpoll.page.html',\n  styleUrls: ['./joinpoll.page.scss'],\n})\nexport class JoinpollPage implements OnInit {\n\n  window = window;\n\n  help_link_start = '<a href=\"/help\">';\n  help_link_end = '</a>';\n\n  db_server_url: string;\n  db_password: string;\n  pid: string;\n  poll_password: string;\n  p: Poll;\n\n  // LIFECYCLE:\n\n  ready = false;  \n\n  constructor(\n    public router: Router,\n    private route: ActivatedRoute,\n    public translate: TranslateService,\n    public G: GlobalService) {\n    this.G.L.entry(\"JoinpollPage.constructor\");\n    this.route.params.subscribe( params => { \n      this.db_server_url = params['db_server_url'];\n      this.db_password = params['db_password'];\n      this.pid = params['pid'];\n      this.poll_password = params['poll_password'];\n    } );\n  }\n\n  ngOnInit() {\n    this.G.L.entry(\"JoinpollPage.ngOnInit\");\n  }\n\n  ionViewWillEnter() {\n    this.G.L.entry(\"JoinpollPage.ionViewWillEnter\");\n    this.G.D.page = this;\n    // TODO: generate poll object and try connecting via data service\n  }\n\n  ionViewDidEnter() {\n    this.G.L.entry(\"JoinpollPage.ionViewDidEnter\");\n    if (this.G.D.ready) {\n      this.onDataReady();\n    }\n    this.G.L.debug(\"JoinpollPage.ready:\", this.ready);\n    // TODO: either go to voting page directly or show some kind of welcome page?\n  }\n\n  onDataReady() {\n    // called when DataService initialization was slower than view initialization\n    this.G.L.entry(\"JoinpollPage.onDataReady\");\n    if (this.pid in this.G.P.polls) {\n      this.p = this.G.P.polls[this.pid];\n      if (this.p.state == 'draft') {\n        this.G.L.warn(\"JoinpollPage called for draft poll, redirecting to mypolls page\", this.pid);\n        this.router.navigate([\"/mypolls\"]);\n      } else {\n        this.G.L.info(\"JoinpollPage called for known poll, redirecting to polls page\", this.pid);\n        this.router.navigate([\"/poll/\" + this.pid]);\n      }\n    } else {\n      this.G.L.info(\"JoinpollPage called for unknown pid, trying to connect\", this.pid);\n      this.p = new Poll(this.G, this.pid);\n      this.p._state = \"running\";\n      this.p.allow_voting = true;\n      this.p.db_server_url = this.db_server_url;\n      this.p.db_password = this.db_password;\n      this.p.password = this.poll_password;\n      this.p.init_myvid();\n      this.G.D.connect_to_remote_poll_db(this.pid, true).then(() => {\n        // remote poll db has been replicated completely to local poll db\n        this.ready = true;\n        this.p.set_timeouts();\n        this.p.tally_all();\n      });\n    }\n    this.G.L.exit(\"JoinpollPage.onDataReady\");\n  }\n\n  ionViewDidLeave() {\n    this.G.L.entry(\"JoinpollPage.ionViewDidLeave\");\n    this.G.D.save_state();\n    this.G.L.exit(\"JoinpollPage.ionViewDidLeave\");\n  }\n\n  go_button_clicked() {\n    this.router.navigate([\"/poll/\" + this.pid]);\n  }\n}\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}