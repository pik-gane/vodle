{"version":3,"file":"src_app_joinpoll_joinpoll_module_ts.js","mappings":"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","sources":["./src/app/joinpoll/joinpoll.page.scss","./src/app/joinpoll/joinpoll.page.ts","./src/app/joinpoll/joinpoll.module.ts","./src/app/joinpoll/joinpoll-routing.module.ts"],"sourcesContent":["// Imports\nvar ___CSS_LOADER_API_SOURCEMAP_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\");\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `@charset \"UTF-8\";\n/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/app/joinpoll/joinpoll.page.scss\"],\"names\":[],\"mappings\":\"AAAA,gBAAgB;AAAhB;;;;;;;;;;;;;;;;;CAAA\",\"sourcesContent\":[\"/*\\r\\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\\r\\n\\r\\nThis file is part of vodle.\\r\\n\\r\\nvodle is free software: you can redistribute it and/or modify it under the \\r\\nterms of the GNU Affero General Public License as published by the Free \\r\\nSoftware Foundation, either version 3 of the License, or (at your option) \\r\\nany later version.\\r\\n\\r\\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \\r\\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \\r\\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \\r\\ndetails.\\r\\n\\r\\nYou should have received a copy of the GNU Affero General Public License \\r\\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \\r\\n*/\\r\\n\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___.toString();\n","/*\r\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\r\n\r\nThis file is part of vodle.\r\n\r\nvodle is free software: you can redistribute it and/or modify it under the \r\nterms of the GNU Affero General Public License as published by the Free \r\nSoftware Foundation, either version 3 of the License, or (at your option) \r\nany later version.\r\n\r\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \r\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \r\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \r\ndetails.\r\n\r\nYou should have received a copy of the GNU Affero General Public License \r\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \r\n*/\r\n\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\nimport { GlobalService } from \"../global.service\";\r\nimport { Poll } from '../poll.service';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CommonModule } from '@angular/common';\r\n@Component({\r\n  imports: [ CommonModule, IonicModule, TranslateModule ],\r\n  selector: 'app-join',\r\n  templateUrl: './joinpoll.page.html',\r\n  styleUrls: ['./joinpoll.page.scss'],\r\n})\r\nexport class JoinpollPage implements OnInit {\r\n\r\n  window = window;\r\n\r\n  help_link_start = '<a href=\"/help\">';\r\n  help_link_end = '</a>';\r\n\r\n  db_server_url: string;\r\n  db_password: string;\r\n  pid: string;\r\n  poll_password: string;\r\n  p: Poll;\r\n\r\n  // LIFECYCLE:\r\n\r\n  ready = false;  \r\n\r\n  constructor(\r\n    public router: Router,\r\n    private route: ActivatedRoute,\r\n    public translate: TranslateService,\r\n    public G: GlobalService) {\r\n    this.G.L.entry(\"JoinpollPage.constructor\");\r\n    this.route.params.subscribe( params => { \r\n      this.db_server_url = params['db_server_url'];\r\n      this.db_password = params['db_password'];\r\n      this.pid = params['pid'];\r\n      this.poll_password = params['poll_password'];\r\n    } );\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.G.L.entry(\"JoinpollPage.ngOnInit\");\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    this.G.L.entry(\"JoinpollPage.ionViewWillEnter\");\r\n    this.G.D.page = this;\r\n    // TODO: generate poll object and try connecting via data service\r\n  }\r\n\r\n  ionViewDidEnter() {\r\n    this.G.L.entry(\"JoinpollPage.ionViewDidEnter\");\r\n    if (this.G.D.ready) {\r\n      this.onDataReady();\r\n    }\r\n    this.G.L.debug(\"JoinpollPage.ready:\", this.ready);\r\n    // TODO: either go to voting page directly or show some kind of welcome page?\r\n  }\r\n\r\n  onDataReady() {\r\n    // called when DataService initialization was slower than view initialization\r\n    this.G.L.entry(\"JoinpollPage.onDataReady\");\r\n    if (this.pid in this.G.P.polls) {\r\n      this.p = this.G.P.polls[this.pid];\r\n      if (this.p.state == 'draft') {\r\n        this.G.L.warn(\"JoinpollPage called for draft poll, redirecting to mypolls page\", this.pid);\r\n        this.router.navigate([\"/mypolls\"]);\r\n      } else {\r\n        this.G.L.info(\"JoinpollPage called for known poll, redirecting to polls page\", this.pid);\r\n        this.router.navigate([\"/poll/\" + this.pid]);\r\n      }\r\n    } else {\r\n      this.G.L.info(\"JoinpollPage called for unknown pid, trying to connect\", this.pid);\r\n      this.p = new Poll(this.G, this.pid);\r\n      this.p._state = \"running\";\r\n      this.p.allow_voting = true;\r\n      this.p.db_server_url = this.db_server_url;\r\n      this.p.db_password = this.db_password;\r\n      this.p.password = this.poll_password;\r\n      this.p.init_myvid();\r\n      this.G.D.connect_to_remote_poll_db(this.pid, true).then(() => {\r\n        // remote poll db has been replicated completely to local poll db\r\n        this.ready = true;\r\n        this.p.set_timeouts();\r\n        this.p.tally_all();\r\n      });\r\n    }\r\n    this.G.L.exit(\"JoinpollPage.onDataReady\");\r\n  }\r\n\r\n  ionViewDidLeave() {\r\n    this.G.L.entry(\"JoinpollPage.ionViewDidLeave\");\r\n    this.G.D.save_state();\r\n    this.G.L.exit(\"JoinpollPage.ionViewDidLeave\");\r\n  }\r\n\r\n  go_button_clicked() {\r\n    this.router.navigate([\"/poll/\" + this.pid]);\r\n  }\r\n}\r\n","/*\r\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\r\n\r\nThis file is part of vodle.\r\n\r\nvodle is free software: you can redistribute it and/or modify it under the \r\nterms of the GNU Affero General Public License as published by the Free \r\nSoftware Foundation, either version 3 of the License, or (at your option) \r\nany later version.\r\n\r\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \r\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \r\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \r\ndetails.\r\n\r\nYou should have received a copy of the GNU Affero General Public License \r\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \r\n*/\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { JoinpollPageRoutingModule } from './joinpoll-routing.module';\r\n\r\nimport { JoinpollPage } from './joinpoll.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    JoinpollPageRoutingModule,\r\n    TranslateModule.forChild(),\r\n    JoinpollPage\r\n  ]\r\n})\r\nexport class JoinpollPageModule {}\r\n","/*\r\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\r\n\r\nThis file is part of vodle.\r\n\r\nvodle is free software: you can redistribute it and/or modify it under the \r\nterms of the GNU Affero General Public License as published by the Free \r\nSoftware Foundation, either version 3 of the License, or (at your option) \r\nany later version.\r\n\r\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \r\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \r\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \r\ndetails.\r\n\r\nYou should have received a copy of the GNU Affero General Public License \r\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \r\n*/\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { JoinpollPage } from './joinpoll.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: JoinpollPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class JoinpollPageRoutingModule {}\r\n"],"names":["Component","Router","ActivatedRoute","TranslateService","GlobalService","Poll","IonicModule","TranslateModule","CommonModule","JoinpollPage","constructor","router","route","translate","G","window","help_link_start","help_link_end","ready","L","entry","params","subscribe","db_server_url","db_password","pid","poll_password","ngOnInit","ionViewWillEnter","D","page","ionViewDidEnter","onDataReady","debug","P","polls","p","state","warn","navigate","info","_state","allow_voting","password","init_myvid","connect_to_remote_poll_db","then","set_timeouts","tally_all","exit","ionViewDidLeave","save_state","go_button_clicked","__decorate","imports","selector","template","__NG_CLI_RESOURCE__0","NgModule","FormsModule","JoinpollPageRoutingModule","JoinpollPageModule","forChild","RouterModule","routes","path","component","exports"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}