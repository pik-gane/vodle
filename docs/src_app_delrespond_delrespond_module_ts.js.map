{"version":3,"file":"src_app_delrespond_delrespond_module_ts.js","mappings":"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","sources":["./src/app/delrespond/delrespond.module.ts","./src/app/delrespond/delrespond-routing.module.ts","./src/app/delrespond/delrespond.page.ts","./src/app/delrespond/delrespond.page.scss"],"sourcesContent":["/*\r\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\r\n\r\nThis file is part of vodle.\r\n\r\nvodle is free software: you can redistribute it and/or modify it under the \r\nterms of the GNU Affero General Public License as published by the Free \r\nSoftware Foundation, either version 3 of the License, or (at your option) \r\nany later version.\r\n\r\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \r\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \r\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \r\ndetails.\r\n\r\nYou should have received a copy of the GNU Affero General Public License \r\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \r\n*/\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { DelrespondPageRoutingModule } from './delrespond-routing.module';\r\n\r\nimport { DelrespondPage } from './delrespond.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    DelrespondPageRoutingModule,\r\n    TranslateModule.forChild(),\r\n    DelrespondPage\r\n  ]\r\n})\r\nexport class DelrespondPageModule {}\r\n","/*\r\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\r\n\r\nThis file is part of vodle.\r\n\r\nvodle is free software: you can redistribute it and/or modify it under the \r\nterms of the GNU Affero General Public License as published by the Free \r\nSoftware Foundation, either version 3 of the License, or (at your option) \r\nany later version.\r\n\r\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \r\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \r\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \r\ndetails.\r\n\r\nYou should have received a copy of the GNU Affero General Public License \r\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \r\n*/\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { DelrespondPage } from './delrespond.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: DelrespondPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class DelrespondPageRoutingModule {}\r\n","/*\r\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\r\n\r\nThis file is part of vodle.\r\n\r\nvodle is free software: you can redistribute it and/or modify it under the \r\nterms of the GNU Affero General Public License as published by the Free \r\nSoftware Foundation, either version 3 of the License, or (at your option) \r\nany later version.\r\n\r\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \r\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \r\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \r\ndetails.\r\n\r\nYou should have received a copy of the GNU Affero General Public License \r\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \r\n*/\r\n\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { del_agreement_t } from '../data.service';\r\n\r\nimport { GlobalService } from \"../global.service\";\r\nimport { Poll } from '../poll.service';\r\nimport { RouterModule } from '@angular/router';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CommonModule } from '@angular/common';\r\n@Component({\r\n  imports: [ CommonModule, IonicModule, TranslateModule, RouterModule ],\r\n  selector: 'app-join',\r\n  templateUrl: './delrespond.page.html',\r\n  styleUrls: ['./delrespond.page.scss'],\r\n})\r\nexport class DelrespondPage implements OnInit {\r\n\r\n  url: string;\r\n  pid: string;\r\n  p: Poll;\r\n  did: string;\r\n  oids: string[];\r\n  from: string;\r\n  private_key: string;\r\n  agreement: del_agreement_t;\r\n  status: Array<string>;\r\n\r\n  // LIFECYCLE:\r\n\r\n  ready = false;  \r\n\r\n  constructor(\r\n    public router: Router,\r\n    private route: ActivatedRoute,\r\n    public translate: TranslateService,\r\n    public G: GlobalService) {\r\n    this.G.L.entry(\"DelrespondPage.constructor\");\r\n    this.route.params.subscribe( params => { \r\n      this.url = this.router.url;\r\n      this.pid = params['pid'];\r\n      this.did = params['did'];\r\n      this.from = decodeURIComponent(params['from']);\r\n      this.private_key = params['private_key'];\r\n    } );\r\n    this.route.queryParamMap.subscribe(queryParams => {\r\n      this.oids = queryParams.getAll('oids'); // Extract all `oids` values as an array\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.G.L.entry(\"DelrespondPage.ngOnInit\");\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    this.G.L.entry(\"DelrespondPage.ionViewWillEnter\");\r\n    this.G.D.page = this;\r\n  }\r\n\r\n  ionViewDidEnter() {\r\n    this.G.L.entry(\"DelrespondPage.ionViewDidEnter\");\r\n    if (this.G.D.ready) {\r\n      this.onDataReady();\r\n    }\r\n    this.G.L.debug(\"DelrespondPage.ready:\", this.ready);\r\n  }\r\n\r\n  onDataReady() {\r\n    // called when DataService initialization was slower than view initialization\r\n    if (this.pid in this.G.P.polls) {\r\n      this.p = this.G.P.polls[this.pid];\r\n    }else{\r\n      this.p = null;\r\n    }\r\n    this.status = this.G.Del.get_incoming_request_status(this.pid, this.did);\r\n    if (this.status[0] === 'impossible' && this.status[1] === 'poll-unknown') { // poll does not exist, prevents further errors\r\n      this.ready = true;\r\n      return;\r\n    }\r\n    this.G.L.entry(\"DelrespondPage.onDataReady\", this.pid, this.p.state);\r\n    this.G.Del.store_incoming_request(this.pid, this.did, this.from, this.url, this.status[0]);\r\n    this.ready = true;\r\n    this.G.L.exit(\"DelrespondPage.onDataReady\");\r\n  }\r\n\r\n  ionViewDidLeave() {\r\n    this.G.L.entry(\"DelrespondPage.ionViewDidLeave\");\r\n    this.G.D.save_state();\r\n    this.G.L.exit(\"DelrespondPage.ionViewDidLeave\");\r\n  }\r\n\r\n  // GUI callbacks:\r\n\r\n  // TODO: verify that it is still possible to accept the request\r\n  accept() {\r\n    if (this.G.D.get_different_delegation_allowed(this.pid)){\r\n      this.G.Del.accept_different(this.pid, this.did, this.private_key, this.oids);\r\n      this.router.navigate([\"/poll/\" + this.pid]);\r\n      return;\r\n    }\r\n    /** store positive response and go to poll page */\r\n    this.G.Del.accept(this.pid, this.did, this.private_key);\r\n    // TODO: notify that response has been sent\r\n    this.router.navigate([\"/poll/\" + this.pid]);\r\n  }\r\n\r\n  decline() {\r\n    /** store negative response and go to poll page */\r\n    this.G.Del.decline(this.pid, this.did, this.private_key);\r\n    // TODO: notify that response has been sent\r\n    this.router.navigate([\"/poll/\" + this.pid]);\r\n  }\r\n\r\n  // TODO: use to send a different message to the delegator\r\n  decline_due_to_error() {\r\n    /** store negative response and go to poll page */\r\n    this.G.Del.decline_due_to_error(this.pid, this.did, this.private_key);\r\n    this.router.navigate([\"/poll/\" + this.pid]);\r\n  }\r\n\r\n  revoke() {\r\n    /** store negative response and go to poll page */\r\n    this.G.Del.set_delegation_pending(this.pid, this.did);\r\n    this.G.Del.decline(this.pid, this.did, this.private_key);\r\n    this.router.navigate([\"/poll/\" + this.pid]);\r\n  }\r\n\r\n  dismiss() {\r\n    this.router.navigate([\"/mypolls\"]);\r\n  }\r\n\r\n}\r\n","// Imports\nvar ___CSS_LOADER_API_SOURCEMAP_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\");\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `@charset \"UTF-8\";\n/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/app/delrespond/delrespond.page.scss\"],\"names\":[],\"mappings\":\"AAAA,gBAAgB;AAAhB;;;;;;;;;;;;;;;;;CAAA\",\"sourcesContent\":[\"/*\\r\\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\\r\\n\\r\\nThis file is part of vodle.\\r\\n\\r\\nvodle is free software: you can redistribute it and/or modify it under the \\r\\nterms of the GNU Affero General Public License as published by the Free \\r\\nSoftware Foundation, either version 3 of the License, or (at your option) \\r\\nany later version.\\r\\n\\r\\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \\r\\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \\r\\nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \\r\\ndetails.\\r\\n\\r\\nYou should have received a copy of the GNU Affero General Public License \\r\\nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \\r\\n*/\\r\\n\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___.toString();\n"],"names":["NgModule","CommonModule","FormsModule","TranslateModule","IonicModule","DelrespondPageRoutingModule","DelrespondPage","DelrespondPageModule","__decorate","imports","forChild","RouterModule","routes","path","component","exports","Component","Router","ActivatedRoute","TranslateService","GlobalService","constructor","router","route","translate","G","ready","L","entry","params","subscribe","url","pid","did","from","decodeURIComponent","private_key","queryParamMap","queryParams","oids","getAll","ngOnInit","ionViewWillEnter","D","page","ionViewDidEnter","onDataReady","debug","P","polls","p","status","Del","get_incoming_request_status","state","store_incoming_request","exit","ionViewDidLeave","save_state","accept","get_different_delegation_allowed","accept_different","navigate","decline","decline_due_to_error","revoke","set_delegation_pending","dismiss","selector","template","__NG_CLI_RESOURCE__0"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}