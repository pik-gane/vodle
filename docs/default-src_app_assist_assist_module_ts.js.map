{"version":3,"file":"default-src_app_assist_assist_module_ts.js","mappings":"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","sources":["./src/app/assist/assist-routing.module.ts","./src/app/assist/assist.module.ts","./src/app/assist/assist.page.ts"],"sourcesContent":["/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { AssistPage } from './assist.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AssistPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class AssistPageRoutingModule {}\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { AssistPageRoutingModule } from './assist-routing.module';\n\nimport { AssistPage } from './assist.page';\nexport { AssistPage } from './assist.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    AssistPageRoutingModule,\n    TranslateModule.forChild()\n  ],\n  declarations: [AssistPage]\n})\nexport class AssistPageModule {}\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { Component, OnInit, Input, ViewChild } from '@angular/core';\nimport { ModalController, IonContent } from '@ionic/angular';\nimport { TranslateService } from '@ngx-translate/core';\n\nimport { environment } from '../../environments/environment';\nimport { GlobalService } from \"../global.service\";\nimport { PollPage } from '../poll/poll.module';  \n\n@Component({\n  selector: 'app-assist',\n  templateUrl: './assist.page.html',\n  styleUrls: ['./assist.page.scss'],\n})\nexport class AssistPage implements OnInit {\n\n  @Input() P: PollPage;\n  @ViewChild(IonContent, { static: false }) content: IonContent;\n\n  Array = Array;\n  Math = Math;\n  Object = Object;\n  window = window;\n  document = document;\n  environment = environment;\n  JSON = JSON;\n\n  page = \"assist\";\n\n  step = 1;\n  steps_reached = 1;\n  n_steps = 5;\n  changes = false;\n  current_index = 0;\n\n  favourite = \"\";\n  acceptable = {};\n  acceptable_oids = [];\n  estimates = {};\n  thresholded_oids = [];\n  threshold_answer = {};\n  thresholds = {};\n  ratings = {};\n\n  // LIFECYCLE:\n\n  constructor(\n      public translate: TranslateService,\n      private modalController: ModalController,\n      public G: GlobalService) {\n    this.G.L.entry(\"AssistPage.constructor\");\n  }\n\n  ngOnInit() {\n    this.G.L.entry(\"AssistPage.ngOnInit\");\n  }\n\n  ionViewWillEnter() {\n    this.G.L.entry(\"AssistPage.ionViewWillEnter\");\n    this.G.D.page = this;\n    if (this.G.S.default_wap > 0) {\n      for (const oid of this.P.oidsorted) {\n        this.acceptable[oid] = true;\n        this.estimates[oid] = this.G.S.default_wap > 5 ? 105 - this.G.S.default_wap : 100;\n      }\n    } else {\n      for (const oid of this.P.oidsorted) {\n        this.estimates[oid] = 50;\n      }\n    }\n  }\n\n  ionViewDidEnter() {\n    this.G.L.entry(\"AssistPage.ionViewDidEnter\");\n    this.onScroll();\n  }\n\n  onDataReady() {\n    this.G.L.entry(\"AssistPage.onDataReady\");\n  }\n\n  onDataChange() {\n    this.G.L.entry(\"AssistPage.onDataChange\");\n  }\n\n  ionViewWillLeave() {\n    this.G.L.entry(\"AssistPage.ionViewWillLeave\");\n  }\n\n  ionViewDidLeave() {\n    this.G.L.entry(\"AssistPage.ionViewDidLeave\");\n    this.G.D.save_state();\n  }\n\n  set_rating(oid: string, rating: number) {\n    this.ratings[oid] = rating;\n    this.P.p.set_my_own_rating(oid, rating, true);\n  }\n\n  // UI:\n\n  close() {\n    this.modalController.dismiss();\n    this.P.update_order();\n  }\n\n  back() {\n    if (this.step > 1) {\n      this.step = Math.ceil(this.step) - 1;\n      this.changes = false;\n    }\n  }\n\n  forward() {\n    if (this.step < this.steps_reached) {\n      this.step = Math.floor(this.step) + 1;\n    }\n  }\n\n  go_step(step: number) {\n    if (step == 4) {\n      this.thresholded_oids = []\n      for (const oid of this.acceptable_oids) {\n        if (oid != this.favourite) this.thresholded_oids.push(oid);\n      }\n      this.go_index(0);\n    }\n    this.steps_reached = Math.max(this.steps_reached, step);\n    this.step = step;\n  }\n\n  favourite_change() {\n    this.changes = true;\n  }\n  \n  submit_favourite() {\n    this.G.L.entry(\"AssistPage.submit_favourite\", this.favourite);\n    for (const oid of this.P.oidsorted) {\n      if (oid == this.favourite) {\n        this.G.L.trace(\"AssistPage.submit_favourite favourite\", oid, 100);\n        this.set_rating(oid, 100);\n      } else {\n        // make sure it is the sole favourite:\n        const r = Math.min(99, this.P.p.get_my_own_rating(oid));\n        this.G.L.trace(\"AssistPage.submit_favourite other\", oid, r);\n        this.set_rating(oid, r);\n      }\n    }\n    this.G.D.save_state();\n    this.acceptable[this.favourite] = true;\n    this.changes = false;\n    this.step = 1.1;\n  }\n\n  understood_favourite() {\n    this.go_step(2);\n  }\n\n  acceptable_change() {\n    this.changes = true;\n  }\n\n  submit_acceptable() {\n    this.acceptable_oids = [];\n    for (const oid of this.P.oidsorted) {\n      if (this.acceptable[oid]) {\n        this.acceptable_oids.push(oid);\n        if (!(oid in this.estimates)) this.estimates[oid] = 0;\n        if (oid != this.favourite) {\n          // at least give it a rating of one:\n          const r = Math.max(1, this.P.p.get_my_own_rating(oid));\n          this.G.L.trace(\"AssistPage.submit_acceptable other\", oid, r);\n          this.set_rating(oid, r);\n        }\n      } else {\n          // give it a rating of zero:\n          this.G.L.trace(\"AssistPage.submit_acceptable other\", oid, 0);\n          this.set_rating(oid, 0);\n      }\n    }\n    this.changes = false;\n    if (this.acceptable_oids.length > 1) {\n      this.step = 2.1;\n    } else {\n      this.go_step(5);\n    }\n  }\n\n  understood_acceptable() {\n    this.go_step(3);\n  }\n\n  estimate_change() {\n    this.changes = true;\n  }\n\n  submit_estimates() {\n    for (const oid of this.acceptable_oids) {\n      if (!(oid in this.thresholds)) this.thresholds[oid] = 100;\n    }\n    this.changes = false;\n    this.step = 3.1;\n  }\n\n  understood_estimates() {\n    this.go_step(4);\n  }\n\n  go_index(i: number) {\n    this.current_index = i;\n  }\n\n  threshold_yes() {\n    const oid = this.thresholded_oids[this.current_index];\n    if (this.threshold_answer[oid] != true){\n      this.threshold_answer[oid] = true;\n      this.thresholds[oid] = Math.max(0, Math.min(100, this.thresholds[oid], this.estimates[oid]));\n      this.changes = true;\n    }\n  }\n\n  threshold_no() {\n    const oid = this.thresholded_oids[this.current_index];\n    if (this.threshold_answer[oid] != false) {\n      this.threshold_answer[oid] = false;\n      this.thresholds[oid] = Math.min(100, Math.max(0, this.thresholds[oid], this.estimates[oid] + 5));\n      this.changes = true;  \n    }\n  }\n\n  threshold_change() {\n    this.changes = true;\n  }\n\n  submit_threshold() {\n    if (this.current_index+1 < this.thresholded_oids.length) {\n      const oid = this.thresholded_oids[this.current_index];\n      this.current_index++;\n      this.threshold_answer[oid] = null;\n    } else {\n      this.set_thresholded_ratings();\n      this.changes = false;\n      this.go_step(5);\n    }\n  }\n\n  set_thresholded_ratings() {\n    /** set all ratings based on thresholds: */\n    for (const oid of this.thresholded_oids) {\n      const r = Math.max(0, Math.min(100, 105 - this.thresholds[oid]));\n      this.G.L.trace(\"AssistPage.set_ratings\", oid, r);\n      this.set_rating(oid, r);\n    }\n  }\n\n  understood_ratings() {\n    this.close();\n  }\n\n  // deal with scrolling:\n\n  show_up = false;\n  show_down = false;\n\n  async onScroll() {\n    /** find scroll position to be able to react to it */  \n    const elem = this.content;\n  \n    // the ion content has its own associated scrollElement\n    const scrollElement = await (elem as any).getScrollElement();\n    const totalContentHeight = scrollElement.scrollHeight;\n    const viewportHeight = scrollElement.offsetHeight;\n    const scrollPosition = scrollElement.scrollTop;\n    if (totalContentHeight > viewportHeight) {\n      const rel_scroll_position = scrollPosition / (totalContentHeight - viewportHeight);    \n      this.show_down = rel_scroll_position < 1;\n      this.show_up = rel_scroll_position > 0;\n    } else {\n      this.show_down = this.show_up = false;\n    }\n  }\n\n  async scroll_to_top() {\n    const scrollElement = await (this.content as any).getScrollElement();\n    scrollElement.scrollTo(0, 0);\n  }\n  async scroll_to_bottom() {\n    const scrollElement = await (this.content as any).getScrollElement();\n    scrollElement.scrollTo(0, scrollElement.scrollHeight);\n  }\n\n}\n"],"names":["Component","Input","ViewChild","ModalController","IonContent","TranslateService","environment","GlobalService","AssistPage","constructor","translate","modalController","G","Array","Math","Object","window","document","JSON","L","entry","ngOnInit","ionViewWillEnter","D","page","S","default_wap","oid","P","oidsorted","acceptable","estimates","ionViewDidEnter","onScroll","onDataReady","onDataChange","ionViewWillLeave","ionViewDidLeave","save_state","set_rating","rating","ratings","p","set_my_own_rating","close","dismiss","update_order","back","step","ceil","changes","forward","steps_reached","floor","go_step","thresholded_oids","acceptable_oids","favourite","push","go_index","max","favourite_change","submit_favourite","trace","r","min","get_my_own_rating","understood_favourite","acceptable_change","submit_acceptable","length","understood_acceptable","estimate_change","submit_estimates","thresholds","understood_estimates","i","current_index","threshold_yes","threshold_answer","threshold_no","threshold_change","submit_threshold","set_thresholded_ratings","understood_ratings","elem","content","scrollElement","getScrollElement","totalContentHeight","scrollHeight","viewportHeight","offsetHeight","scrollPosition","scrollTop","rel_scroll_position","show_down","show_up","scroll_to_top","scrollTo","scroll_to_bottom","args","static","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}