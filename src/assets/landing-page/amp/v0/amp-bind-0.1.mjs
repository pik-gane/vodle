;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-bind",ev:"0.1",l:!0,f:function(t,e){(()=>{function e(t){return t?Array.prototype.slice.call(t):[]}var{isArray:n}=Array;function r(t,e){const n=[];let r=0;for(let s=0;s<t.length;s++){const i=t[s];e(i,s,t)?n.push(i):(r<s&&(t[r]=i),r++)}return r<t.length&&(t.length=r),n}function s(t,e){for(let n=0;n<t.length;n++)if(e(t[n],n,t))return n;return-1}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var{hasOwnProperty:o,toString:l}=Object.prototype;function u(t){return"[object Object]"===l.call(t)}function c(t){const e=Object.create(null);return t&&Object.assign(e,t),e}function a(t,e){return o.call(t,e)}function h(t,e){return a(t,e)?t[e]:void 0}function d(t,e){if("."==e)return t;let n=t;for(var r,s=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.split("."));!(r=s()).done;){const t=r.value;if(!(t&&n&&void 0!==n[t]&&"object"==typeof n&&a(n,t))){n=void 0;break}n=n[t]}return n}function f(t){return"number"==typeof t&&isFinite(t)}var p="​​​";function m(t){return 1==(null==(e=t)?void 0:e.nodeType)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t;var e}function P(t){return t.indexOf(p)>=0}function A(t,e,n,r,s,i,o,l,u,c,a){return t}function _(t,e,n,s,i,o,l,u,c,a,h){return function(t,e,n="Assertion failed",s){var i,o;if(e)return e;t&&-1==n.indexOf(t)&&(n+=t);let l=3;const u=n.split("%s");let c=u.shift();const a=[c];for(;u.length;){const t=arguments[l++],e=u.shift();c+=m(t)+e,a.push(t,e.trim())}const h=new Error(c);throw h.messageArray=r(a,(t=>""!==t)),null===(i=(o=self).__AMP_REPORT_ERROR)||void 0===i||i.call(o,h),h}(p,t,e,n,s,i,o,l,u,c,a,h)}var v,b=class extends t.BaseElement{getLayoutPriority(){return 1}isAlwaysFixed(){return!0}isLayoutSupported(t){return!0}renderOutsideViewport(){return!0}Xi(){return"<amp-bind-macro> "+(this.element.getAttribute("id")||"<unknown id>")}};function g(){return v||(v=Promise.resolve(void 0))}var E,T=class{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}};function M(t){return JSON.parse(t)}function w(t,e){return t.closest?t.closest(e):function(t,e,n){let r;for(r=t;r&&void 0!==r;r=r.parentElement)if(e(r))return r;return null}(t,(t=>function(t,e){const n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector;return!!n&&n.call(t,e)}(t,e)))}var R=["Webkit","webkit","Moz","moz","ms","O","o"];function y(t,e,n,r,s){const i=function(t,e,n){if(e.startsWith("--"))return e;E||(E=c());let r=E[e];if(!r||n){if(r=e,void 0===t[e]){const n=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(e),s=function(t,e){for(let n=0;n<R.length;n++){const r=R[n]+e;if(void 0!==t[r])return r}return""}(t,n);void 0!==t[s]&&(r=s)}n||(E[e]=r)}return r}(t.style,e,s);if(!i)return;const o=r?n+r:n;t.style.setProperty(function(t){const e=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return R.some((t=>e.startsWith(t+"-")))?`-${e}`:e}(i),o)}var I=self.AMP_CONFIG||{},S=("string"==typeof I.thirdPartyFrameRegex?new RegExp(I.thirdPartyFrameRegex):I.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,V=("string"==typeof I.cdnProxyRegex?new RegExp(I.cdnProxyRegex):I.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function O(t){if(!self.document||!self.document.head)return null;if(self.location&&V.test(self.location.origin))return null;const e=self.document.head.querySelector(`meta[name="${t}"]`);return e&&e.getAttribute("content")||null}var x={thirdParty:I.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:I.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:S,cdn:I.cdnUrl||O("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:V,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:I.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:I.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:I.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:I.geoApiUrl||O("amp-geo-api")},N=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function k(t,e=""){try{return decodeURIComponent(t)}catch(t){return e}}function j(t){const e=c();if(!t)return e;let n;for(;n=N.exec(t);){const t=k(n[1],n[1]),r=n[2]?k(n[2].replace(/\+/g," "),n[2]):"";e[t]=r}return e}function U(t){const{location:e}=t||self;return j(e.originalHash||e.hash)}var C="";function L(t){const e=t||self;return e.__AMP_MODE?e.__AMP_MODE:e.__AMP_MODE=function(t){return{localDev:!1,development:F(t,U(t)),esm:!0,test:!1,rtvVersion:$(t)}}(e)}function $(t){var e;return C||(C=(null===(e=t.AMP_CONFIG)||void 0===e?void 0:e.v)||"012203281422000"),C}function F(t,e){const n=e||U(t);return["1","actions","amp","amp4ads","amp4email"].includes(n.development)||!!t.AMP_DEV_MODE}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var D=self.__AMP_LOG;function B(t,e){throw new Error("failed to call initLogConstructor")}function q(t){return D.user||(D.user=z()),function(t,e){return e&&e.ownerDocument.defaultView!=t}(D.user.win,t)?D.userForEmbed||(D.userForEmbed=z()):D.user}function z(t){return B()}function W(){return D.dev||(D.dev=B())}function J(t,e,n,r,s,i,o,l,u,c,a){return t}function G(t,e,n,r,s,i,o,l,u,c,a){return q().assert(t,e,n,r,s,i,o,l,u,c,a)}function H(t,e){return nt(t=Q(t),e)}function X(t,e){return nt(et(tt(t)),e)}function K(t,e){const n=et(tt(t));return ot(n,e)?nt(n,e):null}function Y(t,e){return function(t,e){const n=st(t,e);if(n)return n;const r=it(t);return r[e]=function(){const t=new T,{promise:e,reject:n,resolve:r}=t;return e.catch((()=>{})),{obj:null,promise:e,resolve:r,reject:n,context:null,ctor:null}}(),r[e].promise}(et(t),e)}function Z(t,e){return st(et(t),e)}function Q(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}function tt(t){return t.nodeType?(e=t,n=(e.ownerDocument||e).defaultView,H(n,"ampdoc")).getAmpDoc(t):t;var e,n}function et(t){const e=tt(t);return e.isSingleDoc()?e.win:e}function nt(t,e){J(ot(t,e));const n=it(t)[e];return n.obj||(J(n.ctor),J(n.context),n.obj=new n.ctor(n.context),J(n.obj),n.context=null,n.resolve&&n.resolve(n.obj)),n.obj}function rt(t,e,n,r,s,i){const o=it(t);let l=o[n];l||(l=o[n]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:i||!1}),!s&&l.ctor||(l.ctor=r,l.context=e,l.sharedInstance=i||!1,l.resolve&&nt(t,n))}function st(t,e){const n=it(t)[e];return n?n.promise?n.promise:(nt(t,e),n.promise=Promise.resolve(n.obj)):null}function it(t){let e=t.__AMP_SERVICES;return e||(e=t.__AMP_SERVICES={}),e}function ot(t,e){const n=t.__AMP_SERVICES&&t.__AMP_SERVICES[e];return!(!n||!n.ctor)}function lt(t,e,n){const r=K(t,e);return r?Promise.resolve(r):function(t,e,n,r){const s=Z(t,e);if(s)return s;const i=tt(t);return i.whenExtensionsKnown().then((()=>{const t=i.getExtensionVersion(n);return t?H(i.win,"extensions").waitForExtension(n,t):null})).then((n=>n?r?Z(t,e):Y(t,e):null))}(t,e,n)}var ut=t=>H(t,"ampdoc"),ct=t=>lt(t,"bind","amp-bind"),at=t=>X(t,"viewer"),ht=t=>H(t,"xhr");function dt(t,e,n,r){const s={detail:n};return Object.assign(s,r),new t.CustomEvent(e,s)}function ft(t){return t.detail}var pt,mt=new Set(["c","v","a","ad"]),Pt=t=>"string"==typeof t?At(t):t;function At(t,e){return pt||(pt=self.document.createElement("a")),function(t,e,n){return t.href="",new URL(e,t.href)}(pt,t)}function _t(t){return x.cdnProxyRegex.test(Pt(t).origin)}function vt(t){if(!_t(t=Pt(t)))return t.href;const e=t.pathname.split("/"),n=e[1];G(mt.has(n),"Unknown path prefix in url %s",t.href);const r=e[2],s="s"==r?"https://"+decodeURIComponent(e[3]):"http://"+decodeURIComponent(r);return G(s.indexOf(".")>0,"Expected a . in origin %s",s),e.splice(1,"s"==r?3:2),s+e.join("/")+function(t,e){if(!t||"?"==t)return"";const n=new RegExp("[?&](amp_(js[^&=]*|gsa|r|kit)|usqp)\\b[^&]*","g"),r=t.replace(n,"").replace(/^[?&]/,"");return r?"?"+r:""}(t.search)+(t.hash||"")}function bt(t){return At(vt(t)).origin}function gt(t,e){return e=Pt(e),new URL(t,e.href).toString()}var Et={NONE:0,OPT_IN:1,ALL:2};function Tt(t,e,n={}){const{expr:r=".",urlReplacement:s=Et.NONE,refresh:i=!1,xssiPrefix:o,url:l=e.getAttribute("src")}=n;!function(t,e,n="source"){var r;G(null!=t,"%s %s must be available",e,n),G("https:"==(r=Pt(r=t)).protocol||"localhost"==r.hostname||"127.0.0.1"==r.hostname||function(t,e){const n=t.length-e.length;return n>=0&&t.indexOf(e,n)==n}(r.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',e,n,t)}(l,e);const u=H(t.win,"batched-xhr");return function(t,e,n,r){const s=(t=>K(t,"url-replace"))(t);return(n>=Et.OPT_IN?s.expandUrlAsync(e):Promise.resolve(e)).then((e=>{if(n===Et.OPT_IN){const e=s.collectDisallowedVarsSync(t);if(e.length>0)throw q().createError(`URL variable substitutions in CORS fetches from dynamic URLs (e.g. via amp-bind) require opt-in. Please add data-amp-replace="${e.join(" ")}" to the <${t.tagName}> element. See https://bit.ly/amp-var-subs.`)}const i={};return t.hasAttribute("credentials")&&(i.credentials=t.getAttribute("credentials")),r&&(i.cache="reload"),{"xhrUrl":e,"fetchOpt":i}}))}(e,l,s,i).then((t=>u.fetchJson(t.xhrUrl,t.fetchOpt))).then((e=>ht(t.win).xssiJson(e,o))).then((t=>{if(null==t)throw new Error("Response is undefined.");return d(t,r||".")})).catch((t=>{throw q().createError("failed fetching JSON data",t)}))}var Mt=class extends t.BaseElement{constructor(t){super(t),this.tPt=void 0,this.ePt=new T}getLayoutPriority(){return 1}isAlwaysFixed(){return!0}isLayoutSupported(t){return!0}buildCallback(){!function(t,e){void 0===e&&(e=t.hasAttribute("hidden")),e?t.removeAttribute("hidden"):t.setAttribute("hidden","")}(this.element,!1),this.element.setAttribute("aria-hidden","true");const{element:t}=this;t.hasAttribute("overridable")&&ct(t).then((e=>{J(e),e.addOverridableKey(t.getAttribute("id"))})),this.parseAndUpdate(),this.element.hasAttribute("src")&&this.nPt(!0),this.registerAction("refresh",(()=>{G(this.element.hasAttribute("src"),'Can\'t refresh <amp-state> without "src" attribute.'),this.nPt(!1,!0)}))}mutatedAttributesCallback(t){if(this.getAmpDoc().hasBeenVisible())void 0!==t.src&&this.element.hasAttribute("src")&&this.nPt(!1);else{const t=this.Xi();W().error(t,"ampdoc must be visible before mutation.")}}renderOutsideViewport(){return!0}parseAndUpdate(){return void 0===this.tPt&&(this.tPt=this.bo(),null!==this.tPt)?this.rPt(this.tPt,!0):g()}bo(){const{children:t}=this.element;if(0==t.length)return null;const e=this.Xi();if(1!=t.length)return this.user().error(e,"Should contain exactly one <script> child."),null;const n=t[0];return"SCRIPT"!=(r=n).tagName||"APPLICATION/JSON"!=(null===(s=r.getAttribute("type"))||void 0===s?void 0:s.toUpperCase())?(this.user().error(e,'State should be in a <script> tag with type="application/json".'),null):function(t,e){try{return M(t)}catch(t){return null==e||e(t),null}}(n.textContent,(t=>{this.user().error(e,"Failed to parse state. Is it valid JSON?",t)}));var r,s}Ce(t,e,n){return Tt(t,this.element,{urlReplacement:e,refresh:n})}JN(t,e){const{element:n}=this,r=this.getAmpDoc(),s=bt(n.getAttribute("src"))===bt(r.win.location)||t?Et.ALL:Et.OPT_IN;return this.Ce(r,s,e).catch((t=>{const e=t?dt(this.win,"amp-state.error",{"response":t.response}):null;(t=>K(t,"action"))(n).trigger(n,"fetch-error",e,1)}))}nPt(t,e){t||(this.ePt=new T);const n=this.ePt;return this.getAmpDoc().whenFirstVisible().then((()=>this.JN(t,e))).then((e=>this.rPt(e,t))).then((()=>n.resolve())).catch((t=>{throw n.resolve(),t}))}getFetchingPromise(){return this.element.hasAttribute("src")?this.ePt.promise:g()}rPt(t,e){if(null==t)return g();const n=G(this.element.id,"<amp-state> must have an id.");return ct(this.element).then((r=>{J(r);const s=c();s[n]=t,r.setState(s,{skipEval:e,skipAmpState:!e})}))}Xi(){return"<amp-state> "+(this.element.getAttribute("id")||"<unknown id>")}};function wt(t){if(A(function(t){const e=t.tagName;return e.startsWith("AMP-")&&!("AMP-STICKY-AD-TOP-PADDING"==e||"AMP-BODY"==e)}(t)),t.createdCallback)return Promise.resolve(t);if(!t.__AMP_UPG_PRM){const e=new T;t.__AMP_UPG_PRM=e.promise,t.__AMP_UPG_RES=e.resolve}const e=t.__AMP_UPG_PRM;return A(e),e}var Rt=/(\S+)(?:\s+(?:(-?\d+(?:\.\d+)?)([a-zA-Z]*)))?\s*(?:,|$)/g;function yt(t){const e=[];let n;for(;n=Rt.exec(t);){const t=n[1];let r,s;if(n[2]){const t=n[3].toLowerCase();if("w"==t)r=parseInt(n[2],10);else{if("x"!=t)continue;s=parseFloat(n[2])}}else s=1;e.push({url:t,width:r,dpr:s})}return new It(e)}var It=class{constructor(t){_(t.length>0,"Srcset must have at least one source"),this.kw=t;let e=!1,n=!1;for(let r=0;r<t.length;r++){const s=t[r];e=e||!!s.width,n=n||!!s.dpr}_(!(e===n),"Srcset must have width or dpr sources, but not both"),t.sort(e?St:Vt),this.jw=e}select(t,e){A(t),A(e);let n=0;return n=this.jw?this.Ow(t*e):this.Tw(e),this.kw[n].url}Ow(t){const e=this.kw;let n=0,r=1/0,s=1/0;for(let o=0;o<e.length;o++){var i;const l=null!==(i=e[o].width)&&void 0!==i?i:0,u=Math.abs(l-t);if(!(u<=1.1*r||t/s>1.2))break;n=o,r=u,s=l}return n}Tw(t){const e=this.kw;let n=0,r=1/0;for(let s=0;s<e.length;s++){const i=Math.abs(e[s].dpr-t);if(!(i<=r))break;n=s,r=i}return n}getUrls(){return this.kw.map((t=>t.url))}stringify(t){const e=[],n=this.kw;for(let r=0;r<n.length;r++){const s=n[r];let i=s.url;t&&(i=t(i)),this.jw?i+=` ${s.width}w`:i+=` ${s.dpr}x`,e.push(i)}return e.join(", ")}};function St(t,e){return _(t.width!=e.width,"Duplicate width: %s",t.width),t.width-e.width}function Vt(t,e){return _(t.dpr!=e.dpr,"Duplicate dpr: %s",t.dpr),t.dpr-e.dpr}var Ot={"class":{denylistedValueRegex:"(^|\\W)i-amphtml-"},"hidden":null,"text":null},xt={"width":null,"height":null},Nt={"AMP-AUDIO":{"album":null,"artist":null,"artwork":null,"controlsList":null,"loop":null,"src":{"allowedProtocols":{"https":!0}},"title":null},"AMP-AUTOCOMPLETE":{"src":{"allowedProtocols":{"https":!0}}},"AMP-BASE-CAROUSEL":{"advance-count":null,"auto-advance-count":null,"auto-advance-interval":null,"auto-advance-loops":null,"auto-advance":null,"horizontal":null,"initial-index":null,"loop":null,"mixed-length":null,"side-slide-count":null,"slide":null,"snap-align":null,"snap-by":null,"snap":null,"visible-count":null},"AMP-BRIGHTCOVE":{"data-account":null,"data-embed":null,"data-player":null,"data-player-id":null,"data-playlist-id":null,"data-video-id":null},"AMP-CAROUSEL":{"slide":null},"AMP-DATE-PICKER":{"max":null,"min":null,"src":{"allowedProtocols":{"https":!0}}},"AMP-GOOGLE-DOCUMENT-EMBED":{"src":null,"title":null},"AMP-IFRAME":{"src":null,"title":null},"AMP-IMG":{"alt":null,"attribution":null,"src":{"allowedProtocols":{"data":!0,"http":!0,"https":!0}},"srcset":{"alternativeName":"src"}},"AMP-LIGHTBOX":{"open":null},"AMP-LIST":{"src":{"allowedProtocols":{"https":!0}},"state":null,"is-layout-container":null},"AMP-RENDER":{"src":{"allowedProtocols":{"https":!0}}},"AMP-SELECTOR":{"disabled":null,"selected":null},"AMP-STATE":{"src":{"allowedProtocols":{"https":!0}}},"AMP-TIMEAGO":{"datetime":null,"title":null},"AMP-TWITTER":{"data-tweetid":null},"AMP-VIDEO":{"album":null,"alt":null,"artist":null,"artwork":null,"attribution":null,"controls":null,"controlslist":null,"loop":null,"poster":null,"preload":null,"src":{"allowedProtocols":{"https":!0}},"title":null},"AMP-YOUTUBE":{"data-videoid":null},"A":{"href":{"allowedProtocols":{"ftp":!0,"geo":!0,"http":!0,"https":!0,"mailto":!0,"maps":!0,"bip":!0,"bbmi":!0,"chrome":!0,"itms-services":!0,"facetime":!0,"fb-me":!0,"fb-messenger":!0,"intent":!0,"line":!0,"microsoft-edge":!0,"skype":!0,"sms":!0,"snapchat":!0,"tel":!0,"tg":!0,"threema":!0,"twitter":!0,"viber":!0,"webcal":!0,"web+mastodon":!0,"wh":!0,"whatsapp":!0}}},"BUTTON":{"disabled":null,"type":null,"value":null},"DETAILS":{"open":null},"FIELDSET":{"disabled":null},"IMAGE":{"xlink:href":{"allowedProtocols":{"http":!0,"https":!0}}},"INPUT":{"accept":null,"accesskey":null,"autocomplete":null,"checked":null,"disabled":null,"height":null,"inputmode":null,"max":null,"maxlength":null,"min":null,"minlength":null,"multiple":null,"pattern":null,"placeholder":null,"readonly":null,"required":null,"selectiondirection":null,"size":null,"spellcheck":null,"step":null,"type":{denylistedValueRegex:"(^|\\s)(button|image|)(\\s|$)"},"value":null,"width":null},"OPTION":{"disabled":null,"label":null,"selected":null,"value":null},"OPTGROUP":{"disabled":null,"label":null},"SECTION":{"data-expand":null,"expanded":null},"SELECT":{"autofocus":null,"disabled":null,"multiple":null,"required":null,"size":null},"SOURCE":{"src":{"allowedProtocols":{"https":!0}},"type":null},"TRACK":{"label":null,"src":{"allowedProtocols":{"https":!0}},"srclang":null},"TEXTAREA":{"autocomplete":null,"autofocus":null,"cols":null,"disabled":null,"maxlength":null,"minlength":null,"pattern":null,"placeholder":null,"readonly":null,"required":null,"rows":null,"selectiondirection":null,"selectionend":null,"selectionstart":null,"spellcheck":null,"wrap":null,"defaulttext":null}},kt={"src":!0,"srcset":!0,"href":!0,"xlink:href":!0},jt=!1;function Ut(t){J(t.defaultView),jt||(jt=!0,function(t){!function(t,e){for(const n in e)y(t,n,e[n])}(t.body,{opacity:1,visibility:"visible","animation":"none"})}(t))}var Ct=/nochunking=1/.test(self.location.hash),Lt=g();function $t(t,e,n){Ct?Lt.then(e):function(t){return function(t,e,n,r){const s=tt(t);rt(et(s),s,"chunk",n)}(t,0,qt),X(t,"chunk")}(t).run(e,n)}var Ft="not_run",Dt=class{constructor(t){this.state=Ft,this.Yi=t}Ji(t){if("run"!=this.state){this.state="run";try{this.Yi(t)}catch(t){throw this.Qi(t),t}}}Xi(){return this.Yi.displayName||this.Yi.name}Qi(t){}Zi(){return!1}ts(){return!1}},Bt=class extends Dt{constructor(t,e,n){super(t),this.ss=n}Qi(t){Ut(self.document)}Zi(){return this.es()}ts(){return this.ss.ns}es(){return this.ss.ampdoc.isVisible()}},qt=class{constructor(t){var e;this.ampdoc=t,this.i=t.win,this.rs=new class{constructor(){this.qi=[]}peek(){const t=this.length;return t?this.qi[t-1].item:null}enqueue(t,e){if(isNaN(e))throw new Error("Priority must not be NaN.");const n=this.Wi(e);this.qi.splice(n,0,{item:t,priority:e})}Wi(t){let e=-1,n=0,r=this.length;for(;n<=r&&(e=Math.floor((n+r)/2),e!==this.length);)if(this.qi[e].priority<t)n=e+1;else{if(!(e>0&&this.qi[e-1].priority>=t))break;r=e-1}return e}forEach(t){let e=this.length;for(;e--;)t(this.qi[e].item)}dequeue(){const t=this.qi.pop();return t?t.item:null}get length(){return this.qi.length}},this.hs=this.os.bind(this),this.us=0,this.ls=!(!this.i.navigator.scheduling||!this.i.navigator.scheduling.isInputPending),this.cs=!1,this.Ki=this.i.document.documentElement.hasAttribute("i-amphtml-no-boilerplate"),this.i.addEventListener("message",(t=>{"amp-macro-task"==t.data&&this.os(null)})),this.ns=!1,(e=t,Y(e,"viewer")).then((()=>{this.ns=!0})),t.onVisibilityChanged((()=>{t.isVisible()&&this.ds()}))}run(t,e){const n=new Dt(t);this.fs(n,e)}runForStartup(t){const e=new Bt(t,this.i,this);this.fs(e,Number.POSITIVE_INFINITY)}fs(t,e){this.rs.enqueue(t,e),this.ds()}ps(t){let e=this.rs.peek();for(;e&&e.state!==Ft;)this.rs.dequeue(),e=this.rs.peek();return e&&t&&this.rs.dequeue(),e}os(t){const e=this.ps(!0);if(!e)return this.cs=!1,this.us=0,!1;let n;try{n=Date.now(),e.Ji(t)}finally{Lt.then().then().then().then().then().then().then().then().then((()=>{this.cs=!1,this.us+=Date.now()-n,this.ds()}))}return!0}_s(t){if(this.Ki&&(this.ls?this.i.navigator.scheduling.isInputPending():this.us>5))return this.us=0,void this.As();Lt.then((()=>{this.hs(t)}))}ds(){if(this.cs)return;const t=this.ps();return t?t.Zi()?(this.cs=!0,void this._s(null)):void(t.ts()&&this.i.requestIdleCallback?function(t,e,n,r){const s=Date.now();t.requestIdleCallback((function e(n){if(n.timeRemaining()<15){const i=2e3-(Date.now()-s);i<=0||n.didTimeout?r(n):t.requestIdleCallback(e,{timeout:i})}else r(n)}),{timeout:2e3})}(this.i,0,0,this.hs):this.As()):void 0}As(){this.i.postMessage("amp-macro-task","*")}},zt=self.__AMP_ERRORS||[];self.__AMP_ERRORS=zt;var Wt=function(t){return(Wt=function(t){const e=function(t){let e=0;return()=>{let t=Math.pow(1.5,e++);return t+=function(t,e){let n=t*(e=e||.3)*Math.random();return Math.random()>.5&&(n*=-1),n}(t),1e3*t}}();return t=>setTimeout(t,e())}())(t)};function Jt(t,e){try{let n;if(t)if(void 0!==t.message)t=function(t){const e=Object.getOwnPropertyDescriptor(t,"message");if(null!=e&&e.writable)return t;const{message:n,stack:r}=t,s=new Error(n);for(const e in t)s[e]=t[e];return s.stack=r,s}(t),n=!0;else{const e=t;(t=new Error(function(t){try{return JSON.stringify(t)}catch(e){return String(t)}}(e))).origError=e}else t=new Error("Unknown error");if(t.reported)return t;if(t.reported=!0,t.messageArray){const e=s(t.messageArray,(t=>null==t?void 0:t.tagName));e>-1&&(t.associatedElement=t.messageArray[e])}const r=e||t.associatedElement;if(r&&r.classList&&r.classList.add("i-amphtml-error"),self.console&&(P(t.message)||!t.expected)){const e=console.error||console.log;t.messageArray?e.apply(console,t.messageArray):r?e.call(console,t.message,r):e.call(console,t.message)}r&&r.dispatchCustomEventForTesting&&r.dispatchCustomEventForTesting("amp:error",t.message),Gt.call(self,void 0,void 0,void 0,void 0,t)}catch(t){setTimeout((function(){throw t}))}return t}function Gt(t,e,n,r,s){!this||!this.document||s&&s.expected||Ut(this.document);let i=!1;try{i=function(t){if(!t.document)return!1;const e=t.document.querySelectorAll("script[src]");for(let t=0;t<e.length;t++)if(!_t(e[t].src.toLowerCase()))return!0;return!1}(self)}catch(t){}if(i&&Math.random()>.01)return;const o=function(t,e,n,r,s,i){t=function(t,e){return e&&(t=e.message?e.message:String(e)),t||(t="Unknown error"),t}(t,s);let o=!(!s||!s.expected);if(/_reported_/.test(t))return;if("CANCELLED"==t)return;const l=!(self&&self.window),u=Math.random();if((function(t){return-1!=t.indexOf("Failed to load:")}(t)||"Script error."==t||l)&&(o=!0,u>.001))return;const c=P(t);if(c&&u>.1)return;const a=Object.create(null);a.v=L().rtvVersion,a.noAmp=i?"1":"0",a.m=t.replace(p,""),a.a=c?"1":"0",a.ex=o?"1":"0",a.dw=l?"1":"0";let h="1p";var d,f;if(h="esm",a.esm="1",a.rt="esm",a.ca=null!==(f=self.AMP_CONFIG)&&void 0!==f&&f.canary?"1":"0",a.bt=(null===(d=self.AMP_CONFIG)||void 0===d?void 0:d.type)||"unknown",self.location.ancestorOrigins&&self.location.ancestorOrigins[0]&&(a.or=self.location.ancestorOrigins[0]),self.viewerState&&(a.vs=self.viewerState),self.parent&&self.parent!=self&&(a.iem="1"),self.AMP&&self.AMP.viewer){const t=self.AMP.viewer.getResolvedViewerUrl(),e=self.AMP.viewer.maybeGetMessagingOrigin();t&&(a.rvu=t),e&&(a.mso=e)}const m=[],A=self.__AMP__EXPERIMENT_TOGGLES||null;var _,v,b;for(const t in A){const e=A[t];m.push(`${t}=${e?"1":"0"}`)}return a.exps=m.join(","),s?(a.el=(null===(_=s.associatedElement)||void 0===_?void 0:_.tagName)||"u",s.args&&(a.args=JSON.stringify(s.args)),c||s.ignoreStack||!s.stack||(a.s=s.stack),s.message&&(s.message+=" _reported_")):(a.f=e||"",a.l=n||"",a.c=r||""),a.r=self.document?self.document.referrer:"",a.ae=zt.join(","),a.fr=self.location.originalHash||self.location.hash,"production"===a.bt&&(a.pt="1"),b=t,(v=zt).length>=25&&v.splice(0,v.length-25+1),v.push(b),a}(t,e,n,r,s,i);o&&Wt((()=>{try{return function(t,e){return e.pt&&Math.random()<.9?g():function(t,e){const n=ut(t);if(!n.isSingleDoc())return Promise.resolve(!1);const r=n.getSingleDoc();if(!r.getRootNode().documentElement.hasAttribute("report-errors-to-viewer"))return Promise.resolve(!1);const s=at(r);return s.hasCapability("errorReporter")?s.isTrustedViewer().then((t=>{return!!t&&(s.sendMessage("error",{"m":(n=e).m,"a":n.a,"s":n.s,"el":n.el,"ex":n.ex,"v":n.v,"pt":n.pt}),!0);var n})):Promise.resolve(!1)}(t,e).then((t=>{if(!t){const t=new XMLHttpRequest;t.open("POST",Math.random()<.1?x.betaErrorReporting:x.errorReporting,!0),t.send(JSON.stringify(e))}}))}(this,o).catch((()=>{}))}catch(t){}}))}var Ht="__AMP_ORIGINAL_TARGET_VALUE_";function Xt(t,e,n){const r=At(gt(t,e));return"data:"==r.protocol||_t(r)||!n?r.href:`${x.cdn}/i/`+("https:"==r.protocol?"s/":"")+encodeURIComponent(r.host)+r.pathname+(r.search||"")+(r.hash||"")}var Kt="amp-bind",Yt=/^(i?-)?amp(html)?-/,Zt={"INPUT":{"checked":!0,"value":!0},"OPTION":{"selected":!0},"TEXTAREA":{"text":!0,"disabled":!0}},Qt=c({"AMP-CAROUSEL":["slide"],"AMP-LIST":["is-layout-container"],"AMP-SELECTOR":["selected"]}),te=["AMP-LIST","AMP-RENDER"];t.registerServiceForDoc("bind",class{constructor(t){this.ampdoc=t,this.i=t.win,this.sPt=t.win,this.iPt=[],this.oPt=function(t,e,n){let r=0,s=0,i=null;function o(){r=0;const n=5e3-(t.Date.now()-s);var l;n>0?r=t.setTimeout(o,n):(l=i,i=null,e.apply(null,l))}return function(...e){s=t.Date.now(),i=e,r||(r=t.setTimeout(o,5e3))}}(this.i,(()=>{this.iPt.length=0})),this.lPt=[],this.uPt=c(),this.gn=X(t,"history"),this.cPt=[],this.aPt=1e3,this.wn=(t=>X(t,"mutator"))(t),this.mi=c(),this.Ee=nt(this.i,"timer"),this.uF=null,this.Ue=at(this.ampdoc),this.Ue.onMessageRespond("premutate",this.hPt.bind(this)),this.dPt=t.whenFirstVisible().then((()=>t.whenReady().then((()=>t.getRootNode())))),this.fPt=this.dPt.then((t=>this.de(t))),this.pPt=new T,this.mPt=null,this.Wt=new class{constructor(){this.Bt=c(),this.Ht=null}get(t){const e=this.Bt[t];return null==e?null:e}whenSignal(t){var e;let n=null===(e=this.Ht)||void 0===e?void 0:e[t];if(!n){const e=this.Bt[t];n=null!=e?{promise:"number"==typeof e?Promise.resolve(e):Promise.reject(e)}:new T,this.Ht||(this.Ht=c()),this.Ht[t]=n}return n.promise}signal(t,e){var n;if(null!=this.Bt[t])return;const r=null!=e?e:Date.now();this.Bt[t]=r;const s=null===(n=this.Ht)||void 0===n?void 0:n[t];null!=s&&s.resolve&&(s.resolve(r),s.resolve=void 0,s.reject=void 0)}rejectSignal(t,e){var n;if(null!=this.Bt[t])return;this.Bt[t]=e;const r=null===(n=this.Ht)||void 0===n?void 0:n[t];null!=r&&r.reject&&(r.reject(e),r.promise.catch((()=>{})),r.resolve=void 0,r.reject=void 0)}reset(t){var e;this.Bt[t]&&delete this.Bt[t];const n=null===(e=this.Ht)||void 0===e?void 0:e[t];n&&!n.resolve&&delete this.Ht[t]}};const e=self.AMP;e.printState=e.printState||this.PPt.bind(this),e.setState=e.setState||(t=>this.setState(t)),e.eval=e.eval||this.APt.bind(this)}signals(){return this.Wt}setState(t,e={}){try{!function(t,e,n=10){const r=[],s=[];for(s.push({t:t,s:e,d:0});s.length>0;){const{d:t,s:e,t:l}=s.shift();if(r.includes(e))throw new Error("Source object has a circular reference.");if(r.push(e),l!==e)if(t>n)Object.assign(l,e);else for(var i=0,o=Object.keys(e);i<o.length;i++){const n=o[i],r=e[n];if(a(l,n)){const e=l[n];if(u(r)&&u(e)){s.push({t:e,s:r,d:t+1});continue}}l[n]=r}}}(this.mi,t,10)}catch(t){q().error(Kt,"Failed to merge result from AMP.setState().",t)}if(e.skipEval)return g();const n=this.fPt.then((()=>this.mN())).then((t=>this._Pt(t,{skipAmpState:e.skipAmpState,constrain:e.constrain})));return this.mPt=n}invoke(t){const{args:e,event:n,method:r,sequenceId:s,tagOrTarget:i}=t;if(this.iPt.includes(s))return q().error(Kt,"One state action allowed per event."),g();this.iPt.push(s),this.oPt();const o=e.__AMP_OBJECT_STRING__;if(o){this.aPt=Math.min(2e3,Math.max(1e3,this.aPt+500)),this.Wt.signal("FIRST_MUTATE");const t={};switch(n&&ft(n)&&(t.event=ft(n)),r){case"setState":return this.setStateWithExpression(o,t);case"pushState":return this.pushStateWithExpression(o,t);default:return Promise.reject(W().createError("Unrecognized method: %s.%s",i,r))}}else q().error("AMP-BIND","Please use the object-literal syntax, e.g. \"AMP.setState({foo: 'bar'})\" instead of \"AMP.setState(foo='bar')\".");return g()}setStateWithExpression(t,e){return this.vPt(t,e).then((t=>this.bPt(t)))}setStateWithObject(t){const e=this.gPt(t);return e?this.bPt(e):Promise.reject("Invalid state")}bPt(t){return this.mPt=this.setState(t).then((()=>this.EPt())).then((t=>{t&&this.gn.replace(t)})),this.mPt}pushStateWithExpression(t,e){return this.vPt(t,e).then((t=>{const e=c();Object.keys(t).forEach((t=>{const n=this.mi[t];e[t]=this.gPt(n)}));const n=()=>this.setState(e);return this.setState(t).then((()=>this.EPt())).then((t=>{this.gn.push(n,t)}))}))}EPt(){const t={"data":{"amp-bind":this.mi},"title":this.sPt.document.title};return this.Ue.isEmbedded()?this.Ue.isTrustedViewer().then((e=>e?t:null)):Promise.resolve(t)}rescan(t,e,n={}){return(n.fast?this.pPt.promise:this.fPt).then((()=>this.Ee.timeoutPromise(n.timeout||2e3,this.TPt(t,e,n),"Timed out waiting for amp-bind to rescan.")))}TPt(t,e,n){return(n.fast?this.MPt(t,e):this.wPt(t,e)).then((()=>{if(n.update)return this.mN().then((e=>this._Pt(e,{constrain:t,evaluateOnly:"evaluate"===n.update})))}))}MPt(t,e){const n=this.RPt(e),r=[],s=t.filter((t=>t.hasAttribute("i-amphtml-binding")));t.forEach((t=>{const e=t.querySelectorAll("[i-amphtml-binding]");Array.prototype.push.apply(s,e)}));const i=this.aPt-this.numberOfBindings();for(let t=0;t<s.length;t++){const e=s[t];if(this.yPt(e,i-r.length,r))break}return n.then((t=>{})),r.length>0?this.IPt(r):g()}getState(t){const e=t?d(this.mi,t):void 0;return u(e)||n(e)?this.gPt(e):e}getStateAsync(t){const e=/^[^.]*/.exec(t)[0];return this.dPt.then((n=>{const r=n.querySelector(`#${s=e,CSS.escape(s)}`);var s;if(!r)throw q().createError(Kt,`#${e} does not exist.`);return wt(r).then((t=>t.getImpl(!0))).then((t=>t.getFetchingPromise())).catch((()=>{})).then((()=>this.getState(t)))}))}getStateValue(t){const e=d(this.mi,t);return null==e?null:u(e)||n(e)?JSON.stringify(e):String(e)}de(t){const n=!function(t,e){const n=e.documentElement;return["⚡4email","amp4email"].some((t=>n.hasAttribute(t)))}(0,this.sPt.document);return this.uF=new class{constructor(t){this.aN=t}canBind(t,e){return void 0!==this.cN(t,e)}isResultValid(t,e,n){let r=this.cN(t,e);if(r&&r.alternativeName&&(r=this.cN(t,r.alternativeName)),void 0===r)return!1;if(null===r)return!0;if(n&&h(kt,e)){let t;if("srcset"===e){let e;try{e=yt(n)}catch(t){return q().error("amp-bind","Failed to parse srcset: ",t),!1}t=e.getUrls()}else t=[n];for(let e=0;e<t.length;e++)if(!this.hN(t[e],r))return!1}const{denylistedValueRegex:s}=r;return!(n&&s&&new RegExp(s,"i").test(n))}hN(t,e){if(t){if(/__amp_source_origin/.test(t))return!1;const{allowedProtocols:n}=e;if(n){const e=/^([^:\/?#.]+):[\s\S]*$/.exec(t);if(null!==e&&!a(n,e[1].toLowerCase().trim()))return!1}}return!0}cN(t,e){if(e.startsWith("aria-"))return null;if(h(kt,e)&&!this.aN)return;const n=h(Ot,e);if(void 0!==n)return n;const r=h(xt,e);if(t.startsWith("AMP-")&&void 0!==r)return r;const s=h(Nt,t);return s?s[e]:void 0}}(n),this.SPt("bind.init",[n]).then((()=>Promise.all([this.VPt().then((()=>this.pPt.resolve())),this.OPt([t])]))).then((()=>{t.addEventListener("amp:dom-update",(t=>this.U_t(t)))})).then((()=>{const n=e(t.querySelectorAll("AMP-STATE")).map((t=>wt(t).then((()=>t.getImpl(!1))).then((t=>t.parseAndUpdate()))));return Promise.all(n)})).then((()=>{this.Ue.sendMessage("bindReady",void 0),this.xPt("amp:bind:initialize")}))}numberOfBindings(){return this.lPt.reduce(((t,e)=>t+e.boundProperties.length),0)}setMaxNumberOfBindingsForTesting(t){this.aPt=t}historyForTesting(){return this.gn}hPt(t){const e=[];return this.fPt.then((()=>(Object.keys(t.state).forEach((n=>{this.cPt.includes(n)||(delete t.state[n],e.push(n))})),e.length,this.setState(t.state))))}addOverridableKey(t){this.cPt.push(t)}VPt(){const t=this.ampdoc.getBody().querySelectorAll("AMP-BIND-MACRO"),e=[];return function(t,e){const{length:n}=t;for(let r=0;r<n;r++)e(t[r])}(t,(t=>{const n=(t.getAttribute("arguments")||"").split(",").map((t=>t.trim()));e.push({id:t.getAttribute("id"),argumentNames:n,expressionString:t.getAttribute("expression")})})),0==e.length?Promise.resolve(0):this.SPt("bind.addMacros",[e]).then((n=>(n.forEach(((e,n)=>{this.NPt(e,`${Kt}: Parsing amp-bind-macro failed.`,t[n])})),e.length)))}OPt(t){if(!t.length)return Promise.resolve(0);const e=t.map((t=>{const e=this.aPt-this.numberOfBindings();return this.TE(t,e).then((t=>{const{bindings:e,limitExceeded:n}=t;return n&&this.kPt(),e}))}));return Promise.all(e).then((t=>{const e=Array.prototype.concat.apply([],t);return e.length>0?this.IPt(e):0}))}kPt(){W().expectedError(Kt,"Maximum number of bindings reached (%s). Additional elements with bindings will be ignored.",this.aPt)}IPt(t){return this.SPt("bind.addBindings",[t]).then((e=>(Object.keys(e).forEach((t=>{const n=this.uPt[t];n.length>0&&this.NPt(e[t],`${Kt}: Expression compile error in "${t}".`,n[0])})),t.length)))}RPt(t){if(!t.length)return Promise.resolve(0);r(this.lPt,(e=>{for(let n=0;n<t.length;n++)if(t[n].contains(e.element))return!0;return!1}));const e=[];for(const n in this.uPt){const s=this.uPt[n];r(s,(e=>{for(let n=0;n<t.length;n++)if(t[n].contains(e))return!0;return!1})),0==s.length&&(e.push(n),delete this.uPt[n])}const n=e.length;return n>0?this.SPt("bind.removeBindingsWithExpressionStrings",[e]).then((()=>n)):Promise.resolve(0)}TE(t,n){const r=[],s=new class{constructor(t){const n=J(t.nodeType==Node.DOCUMENT_NODE?t:t.ownerDocument),r=n.documentElement.hasAttribute("i-amphtml-binding");this.jPt=r,this.currentNode=t,this.Se=0,this.UPt=r?e(t.querySelectorAll("[i-amphtml-binding]")):[],r&&t.nodeType===Node.ELEMENT_NODE&&t.hasAttribute("i-amphtml-binding")&&this.UPt.unshift(t),this.CPt=r?null:n.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null,!1)}nextNode(){if(this.jPt){if(this.Se==this.UPt.length)return null;const t=this.UPt[this.Se++];return this.currentNode=t,t}const t=this.CPt.nextNode();return null!==t&&(this.currentNode=t),t}skipSubtree(){if(this.jPt){const{currentNode:t}=this;let e=null;do{e=this.nextNode()}while(null!==e&&t.contains(e));return e}const t=this.CPt;for(let e=t.currentNode;e;e=t.parentNode()){const e=t.nextSibling();if(null!==e)return this.currentNode=e,e}return null}}(t);let i=!1;const o=()=>{const t=s.currentNode;if(t.nodeType!==Node.ELEMENT_NODE)return!s.nextNode();const e=t,o=n-r.length;return this.yPt(e,o,r)&&(i=!0),!(te.includes(t.nodeName)?s.skipSubtree():s.nextNode())||i};return new Promise((t=>{const e=n=>{let s=!1;if(n&&!n.didTimeout)for(;n.timeRemaining()>1&&!s;)s=o();else{const t=250;for(let e=0;e<t&&!s;e++)s=o()}s?t({bindings:r,limitExceeded:i}):$t(this.ampdoc,e,10)};$t(this.ampdoc,e,10)}))}yPt(t,e,n){let r=!1;const s=this.LPt(t);s.length>e&&(s.length=e,r=!0),s.length>0&&this.lPt.push({element:t,boundProperties:s});const{tagName:i}=t;return s.forEach((e=>{const{expressionString:r,property:s}=e;n.push({tagName:i,property:s,expressionString:r}),this.uPt[r]||(this.uPt[r]=[]),this.uPt[r].push(t)})),r}LPt(t){const e=[],n=t.attributes;for(let r=0,s=n.length;r<s;r++){const s=n[r],i=this.$Pt(s,t);i&&e.push(i)}return e}$Pt(t,e){const n=e.tagName,r=t.name;let s;if(r.length>2&&"["===r[0]&&"]"===r[r.length-1])s=r.substr(1,r.length-2);else if(r.startsWith("data-amp-bind-")&&(s=r.substr(14),e.hasAttribute(`[${s}]`)))return null;if(s){if(this.uF.canBind(n,s))return{property:s,expressionString:t.value};{const t=q().createError("%s: Binding to [%s] on <%s> is not allowed.",Kt,s,n);this.FPt(t,e)}}return null}vPt(t,e){return this.fPt.then((()=>(Object.assign(e,this.mi),this.SPt("bind.evaluateExpression",[t,e])))).then((t=>{const{error:e,result:n}=t;if(e)throw this.NPt(e,`${Kt}: Expression eval failed.`);return n}))}mN(){return this.SPt("bind.evaluateBindings",[this.mi]).then((t=>{const{errors:e,results:n}=t;return Object.keys(e).forEach((t=>{const n=this.uPt[t];if(n.length>0){const r=e[t],s=q().createError('%s: Expression evaluation error in "%s". %s',Kt,t,r.message);s.stack=r.stack,this.FPt(s,n[0])}})),n}))}Dx(t,e=null,n=!0){const r={};return this.lPt.forEach((n=>{const{boundProperties:s,element:i}=n;e&&!this.DPt(e,i)||s.forEach((e=>{const n=t[e.expressionString];if(void 0===n)return;const s=this.BPt(e,i,n);if(!s)return;const{tagName:o}=i,{expressionString:l,property:u}=e,{actual:c,expected:a}=s;r[`${o}[${u}]${a}:${c}`]=!0}))})),Object.keys(r)}DPt(t,e){for(let n=0;n<t.length;n++)if(t[n].contains(e))return!0;return!1}qPt(t,e){const r=[];return t.forEach((t=>{const{expressionString:s,previousResult:i}=t,o=e[s];void 0===o||function(t,e,r=5){if(!isFinite(r)||r<0)throw new Error("Invalid depth: "+r);if(t===e)return!0;const s=[{a:t,b:e,depth:r}];for(;s.length>0;){const{a:t,b:e,depth:r}=s.shift();if(r>0){if(typeof t!=typeof e)return!1;if(n(t)&&n(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)s.push({a:t[n],b:e[n],depth:r-1});continue}if(t&&e&&"object"==typeof t&&"object"==typeof e){const n=Object.keys(t),l=Object.keys(e);if(n.length!==l.length)return!1;for(var i=0,o=n;i<o.length;i++){const n=o[i];s.push({a:t[n],b:e[n],depth:r-1})}continue}}if(t!==e)return!1}return!0}(o,i,20)||(t.previousResult=o,r.push({boundProperty:t,newValue:o}))})),r}_Pt(t,e){const n=[];return this.lPt.forEach((r=>{if(e.skipAmpState&&"AMP-STATE"===r.element.tagName)return;if(e.constrain&&!e.constrain.some((t=>t.contains(r.element))))return;const{boundProperties:s,element:i}=r,o=this.qPt(s,t);e.evaluateOnly||n.push(this.zPt(i,o))})),Promise.all(n)}zPt(t,e){return 0===e.length?g():this.wn.mutateElement(t,(()=>{const n=c();let r,s;if(e.forEach((e=>{const{boundProperty:i,newValue:o}=e,{property:l}=i,u=this.WPt(i,t,o);u&&(n[u.name]=u.value,"width"==l?r=f(o)?Number(o):r:"height"==l&&(s=f(o)?Number(o):s)),this.JPt(t,l)})),void 0===r&&void 0===s||this.wn.forceChangeSize(t,s,r),"function"==typeof t.mutatedAttributesCallback)try{t.mutatedAttributesCallback(n)}catch(e){const r=q().createError("%s: Applying expression results (%s) failed with error,",Kt,JSON.stringify(n),e);this.FPt(r,t)}}))}JPt(t,e){const n=Zt[t.tagName];if(!n||!n[e])return;const r="OPTION"===t.tagName?w(t,"SELECT"):t;if(r){const t=dt(this.sPt,"amp:form-value-change",null,{bubbles:!0});r.dispatchEvent(t)}}WPt(t,e,n){const{property:r}=t,s=e.tagName;switch(r){case"defaulttext":e.textContent=String(n);break;case"text":const t=String(n);"TITLE"===s&&e.parentNode===this.sPt.document.head&&(this.sPt.document.title=t),"TEXTAREA"===s?e.value=t:e.textContent=t;break;case"class":const i=[];for(let t=0;t<e.classList.length;t++){const n=e.classList[t];Yt.test(n)&&i.push(n)}if(Array.isArray(n)||"string"==typeof n)e.setAttribute("class",i.concat(n).join(" "));else if(null===n)e.setAttribute("class",i.join(" "));else{const t=q().createError('%s: "%s" is not a valid result for [class].',Kt,n);this.FPt(t,e)}break;default:const o="INPUT"===s&&r in e,l=e.getAttribute(r);let u=!1;if("boolean"==typeof n?(o&&e[r]!==n&&(e[r]=n,u=!0),n&&""!==l?(e.setAttribute(r,""),u=!0):n||null===l||(e.removeAttribute(r),u=!0),u&&this.GPt(e,r,n)):"object"==typeof n&&null!==n?u=!0:n!==l&&(u=this.HPt(e,r,String(n),o)),u)return{name:r,value:n}}return null}GPt(t,n,r){if("OPTION"!==t.tagName||"selected"!==n)return;if(!r)return;if(!(s=this.i,H(s,"platform")).isSafari())return;var s;const i=w(t,"select");if(!i)return;const o=e(i.options).indexOf(t);o>=0&&(i.selectedIndex=o)}HPt(t,e,n,r){try{return function(t,e,n,r,s){const i=t.tagName.toLowerCase(),o=e.toLowerCase(),l=function(t,e,n){return function(t){return"src"==t||"href"==t||"xlink:href"==t||"srcset"==t}(e)?function(t,e,n,r){var s;G(!("__amp_source_origin"in j(At(s=n).search)),"Source origin is not allowed in %s",s);const i=_t(r),o=At(vt(r));if("href"==e&&!n.startsWith("#"))return gt(n,o);if("src"==e)return"amp-img"==t?Xt(n,o,i):gt(n,o);if("srcset"==e){let t;try{t=yt(n)}catch(t){return q().error("URL-REWRITE","Failed to parse srcset: ",t),n}return t.stringify((t=>Xt(t,o,i)))}return n}(t,e,n,self.location):n}(i,o,n);if(_t(self.location)&&"a"===i&&"href"===o){const e=t.getAttribute(o),n="#"===l[0],r=e&&"#"===e[0];n&&!r?(t[Ht]||(t[Ht]=t.getAttribute("target")),t.removeAttribute("target")):r&&!n&&t.setAttribute("target",t[Ht]||"_top")}s&&(t[o]=l),t.setAttribute(o,l)}(t,e,n,0,r),!0}catch(r){const s=q().createError('%s: "%s" is not a valid result for [%]',Kt,n,e,r);this.FPt(s,t)}return!1}BPt(t,e,n){const{property:r}=t,{tagName:s}=e,i=Qt[s];if(i&&i.includes(r))return null;let o,l;switch(r){case"text":o=e.textContent,n=String(n),l=o.trim()===n.trim();break;case"class":o=[];for(let t=0;t<e.classList.length;t++){const n=e.classList[t];Yt.test(n)||o.push(n)}let t=[];if(Array.isArray(n))t=n;else if("string"==typeof n){const e=n.trim();e.length>0&&(t=e.split(" "))}else{const t=q().createError('%s: "%s" is not a valid result for [class].',Kt,n);this.FPt(t,e)}l=this.XPt(o,t);break;default:o=e.getAttribute(r),l=!0===n?""===o:!1===n?null===o:"number"==typeof n?Number(o)===n:o===n}return l?null:{expected:n,actual:o}}U_t(t){const e=t.target,n=e.parentNode;n&&te.includes(n.nodeName)||this.wPt([e],[e],"dom_update.end").then((()=>{this.xPt("amp:bind:rescan-template")}))}wPt(t,e,n="rescan.slow"){let r=0;return this.RPt(e).then((e=>(r=e,this.OPt(t)))).then((t=>{}))}SPt(t,e){return function(t,e,n,r){return t.Worker?(function(t,e,n,r){rt(t=Q(t),t,"amp-worker",n)}(t,0,class{constructor(t){this.i=t,this.eR=ht(t);const e=(t.location,`${x.cdn}/rtv/${L().rtvVersion}/ww.mjs`);this.KPt=null,this.YPt=this.eR.fetchText(e,{ampCors:!1,bypassInterceptorForDev:!1}).then((t=>t.text())).then((n=>{const r=`${e}.map`;n=n.replace(/^\/\/# sourceMappingURL=.*/,`//# sourceMappingURL=${r}`);const s=new t.Blob([n+"\n//# sourceurl="+e],{type:"text/javascript"}),i=t.URL.createObjectURL(s);this.KPt=new t.Worker(i),this.KPt.onmessage=this.ZPt.bind(this)})),this.vt={},this.mE=0,this.QPt=[t]}I(t,e,n){return this.YPt.then((()=>new Promise(((r,s)=>{const i=this.mE++;this.vt[i]={method:t,resolve:r,reject:s};const o=this.qAt(n||this.i),l={method:t,args:e,scope:o,id:i};this.KPt.postMessage(l)}))))}ZPt(t){const{id:e,method:n,returnValue:r}=t.data,s=this.vt[e];s?(A(n==s.method),s.resolve(r),delete this.vt[e]):W().error("web-worker",`Received unexpected message (${n}, ${e}) from worker.`)}hasPendingMessages(){return Object.keys(this.vt).length>0}qAt(t){const e=this.QPt.indexOf(t);return e>=0?e:this.QPt.push(t)-1}fetchPromiseForTesting(){return this.YPt}}),H(t,"amp-worker").I(e,n||[],r)):Promise.reject("Worker not supported in window.")}(this.i,t,e,this.sPt)}NPt(t,e,n){const r=q().createError("%s %s",e,t.message);return r.stack=t.stack,this.FPt(r,n),r}FPt(t,e){Jt(t,e)}XPt(t,r){if(t.length!==r.length)return!1;const s=(n(t)?t:e(t)).sort(),i=(n(r)?r:e(r)).sort();for(let e=0;e<t.length;e++)if(s[e]!==i[e])return!1;return!0}gPt(t){if(void 0===t)return null;try{return M(JSON.stringify(t))}catch(e){W().error(Kt,"Failed to copy JSON ("+t+") with error: "+e)}return null}PPt(t){if(t)if("string"==typeof t)d(this.mi,t);else if(t.nodeType==Node.ELEMENT_NODE){const e=q().assertElement(t);this.XAt(e)}}XAt(t){const e=s(this.lPt,(e=>e.element==t));if(e<0)return;const n=[],{boundProperties:r}=this.lPt[e];r.forEach((t=>{const{expressionString:e}=t;n.push(this.vPt(e,this.mi))})),Promise.all(n).then((t=>{const e=c();r.forEach(((n,r)=>{const{property:s}=n;e[s]=t[r]}))}))}APt(t){this.vPt(t,this.mi).then((t=>{}))}initializePromiseForTesting(){return this.fPt}setStatePromiseForTesting(){return this.mPt}xPt(t){}}),t.registerElement("amp-state",Mt),t.registerElement("amp-bind-macro",b)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-bind-0.1.mjs.map